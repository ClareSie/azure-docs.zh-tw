---
title: 分區和示例：模組參考
titleSuffix: Azure Machine Learning
description: 瞭解如何使用 Azure 機器學習中的分區和示例模組對資料集執行採樣或從資料集創建分區。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/22/2019
ms.openlocfilehash: 0392a05df485b45b1244f4542ed55af1837dca3d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2020
ms.locfileid: "79477505"
---
# <a name="partition-and-sample-module"></a>分區和示例模組

本文介紹 Azure 機器學習設計器（預覽）中的模組。

使用分區和示例模組對資料集執行採樣或從資料集創建分區。

取樣是重要的工具，在機器學習，因為它可讓您同時維持相同值的比例減少資料集的大小。 本模組支援機器學習中重要的幾個相關任務： 

- 將資料劃分為相同大小的多個小節。 

  您可以使用分區進行交叉驗證，或將案例分配給隨機組。

- 將資料分成組，然後處理特定組的資料。 

  隨機將事例分配給不同的組後，可能需要修改僅與一個組關聯的要素。

- 取樣。 

  您可以提取資料的百分比、應用隨機採樣或選擇要用於平衡資料集的列，並對其值執行分層採樣。

- 創建用於測試的較小資料集。 

  如果資料很多，則可能需要在設置管道時僅使用前*n*行，然後在生成模型時切換到使用完整資料集。 您還可以使用採樣創建用於開發的小型資料集。

## <a name="configure-the-module"></a>配置模組

此模組支援以下將資料劃分為分區或採樣的方法。 首先選擇該方法，然後設置該方法所需的其他選項。

- Head
- 取樣
- 分配給折疊
- 挑選摺疊

### <a name="get-top-n-rows-from-a-dataset"></a>從資料集獲取 TOP N 行

使用此模式可取得的第一個*n*資料列。 如果要在少量行上測試管道，並且不需要以任何方式平衡或採樣資料，則此選項非常有用。

1. 將**分區和示例**模組添加到介面中的管道中，並串連資料組。  

1. **分區或採樣模式**：將此選項設置為**頭**。

1. **要選擇的行數**：輸入要返回的行數。

   行數必須為非負整數。 如果所選行數大於資料集中的行數，則返回整個資料集。

1. 提交管道。

模組輸出僅包含指定行數的單個資料集。 行始終從資料集頂部讀取。

### <a name="create-a-sample-of-data"></a>創建資料示例

此選項支援簡單的隨機採樣或分層隨機採樣。 如果要創建較小的代表性示例資料集以進行測試，則它很有用。

1. 將**分區和示例**模組添加到管道中，並串連資料組。

1. **分區或採樣模式**：將此選項設置為**採樣**。

1. **取樣速率**：輸入介於 0 和 1 之間的值。 此值指定應包含在輸出資料集中的源資料集中的行的百分比。

   例如，如果只想要原始資料集的一半，請輸入`0.5`以指示取樣速率應為 50%。

   根據指定的比率，對輸入資料集的行進行隨機排列並有選擇地放置在輸出資料集中。

1. **用於採樣的隨機種子**：可選，輸入一個整數用作種子值。

   如果您希望每次以相同的方式劃分行，則此選項非常重要。 預設值為**0，** 這意味著基於系統時鐘生成起始種子。 每次運行管道時，此值都會導致略有不同的結果。

1. **用於採樣的分層拆分**：如果資料集中的行在採樣前均勻地除以某些鍵列，請選擇此選項。

   對於**用於採樣的分層鍵列**，請選擇在劃分資料集時要使用的單個*地層列*。 然後，資料集中的行按如下方式劃分：

   1. 所有輸入行都由指定地層列中的值分組（分層）。

   1. 將每個群組內的資料列打散

   1. 選擇性地將每個群組加入至輸出資料集，以符合指定的比率。


1. 提交管道。

   使用此選項，模組將輸出包含資料代表性採樣的單個資料集。 不輸出資料集的剩餘未採樣部分。 

## <a name="split-data-into-partitions"></a>將資料拆分為分區

如果要將資料集劃分為數據子集，請使用此選項。 如果要創建用於交叉驗證的自訂折疊數或將行拆分為多個組，此選項也很有用。

1. 將**分區和示例**模組添加到管道中，並串連資料組。

1. 對於**分區或示例模式**，選擇"**分配給折疊**"。

1. **在分區中使用替換**：如果您希望將採樣行放回行池以進行可能的重用，請選擇此選項。 因此，同一行可能分配給多個折疊。

   如果不使用替換（預設選項），則採樣行不會放回行池以進行潛在重用。 因此，每行只能分配給一個折疊。

1. **隨機拆分**：如果您希望將行隨機分配給折疊，請選擇此選項。

   如果未選擇此選項，則行將分配給通過迴圈方法折疊。

1. **隨機種子**：可選，輸入一個整數用作種子值。 如果您希望每次以相同的方式劃分行，則此選項非常重要。 否則，預設值**0**表示將使用隨機啟動種子。

1. **指定分區器方法**：使用以下選項指示您希望將資料分攤到每個分區的方式：

   - **分區均勻：** 使用此選項在每個分區中放置相同數量的行。 要指定輸出分區數，請在 **"指定折疊數"中輸入整數，以均勻地拆分為**框。

   - **具有自訂比例的分區**：使用此選項將每個分區的大小指定為逗號分隔清單。

     例如，假設您要創建三個分區。 第一個分區將包含 50% 的資料。 其餘兩個分區將各包含 25% 的資料。 在 **"以逗號分隔的比例清單"** 框中，輸入這些數位 **：.5、.25、.25**。

     所有分區大小的總和必須加起來正好為 1。

     如果輸入的數位加起來*小於 1，* 則將創建一個額外的分區來保存其餘行。 例如，如果輸入值 **.2**和 **.3，** 則將創建第三個分區以保存所有行的剩餘 50%。
     
     如果輸入的數位加起來*超過 1，* 則在運行管道時將引發錯誤。

1. **分層拆分**：如果希望在拆分時將行分層，請選擇此選項，然後選擇 _"地層"列_。

1. 提交管道。

   使用此選項，模組將輸出多個資料集。 資料集根據您指定的規則進行分區。

### <a name="use-data-from-a-predefined-partition"></a>使用預定義分區中的資料  

將資料集劃分為多個分區，現在希望依次載入每個分區以進行進一步分析或處理時，請使用此選項。

1. 將**分區和示例**模組添加到管道中。

1. 將模組連接到分區**和示例**的上一個實例的輸出。 該實例必須使用"**分配給折疊"** 選項來生成一定數量的分區。

1. **分區或採樣模式**：選擇 **"選取折疊**"。

1. **指定要從**：選擇分區以輸入其索引來採樣的折疊。 分區索引基於 1。 例如，如果將資料集劃分為三個部分，則分區將具有索引 1、2 和 3。

   如果輸入不正確索引值，則引發設計時錯誤："錯誤 0018：資料集包含無效資料。

   除了按折疊對資料集進行分組外，還可以將資料集分成兩組：目標折疊和所有其他。 為此，請輸入單個折疊的索引，然後選擇**所選折疊的"選取補補"** 選項，以獲取指定折疊中除資料外的所有內容。

1. 如果使用多個分區，則必須添加更多**分區和示例**模組的實例來處理每個分區。

   例如，第二行中的**分區和示例**模組設置為 **"分配給折疊**"，第三行中的模組設置為 **"選取折疊**"。   

   ![資料分割和取樣](./media/module/partition-and-sample.png)

1. 提交管道。

   使用此選項，模組將輸出僅包含分配給該折疊的行的單個資料集。

> [!NOTE]
>  無法直接查看折疊名稱。 它們僅存在於中繼資料中。

## <a name="next-steps"></a>後續步驟

請參閱 Azure 機器學習[可用的模組集](module-reference.md)。 