---
title: SMOTE
titleSuffix: Azure Machine Learning
description: 瞭解如何使用 Azure 機器學習中的 SMOTE 模組通過使用過採樣來增加資料集中的低發生率示例數。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/16/2019
ms.openlocfilehash: ed6d9e86143c3a5d6c97c4bd92a07c258bbd1bbc
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2020
ms.locfileid: "79477454"
---
# <a name="smote"></a>SMOTE

本文介紹如何使用 Azure 機器學習設計器（預覽）中的 SMOTE 模組來增加用於機器學習的資料集中代表性不足的情況數。 與簡單地複製現有案例相比，SMOTE 是增加罕見病例數量的更好方法。  

將 SMOTE 模組連接到*不平衡*的資料集。 資料集可能不平衡的原因有很多。 例如，您定位的類別在總體中可能很少見，或者資料可能難以收集。 通常，當您要分析的*類*代表性不足時，可以使用 SMOTE。 
  
該模組返回包含原始示例的資料集。 它還返回許多合成少數樣本，具體取決於您指定的百分比。  
  
## <a name="more-about-smote"></a>關於SMOTE

合成少數超採樣技術 （SMOTE） 是一種統計技術，用於以平衡的方式增加資料集中的案例數。 該模組的工作原理是從作為輸入提供的現有少數案例生成新實例。 SMOTE 的這種實施*不會改變*多數案例的數量。

新的實例不僅僅是現有少數案例的副本。 相反，該演算法獲取每個目標類及其最近鄰域*的特徵空間*樣本。 然後，該演算法生成新的示例，將目標大小寫的特徵與其相鄰要素相結合。 此方法能增加每個類別可用的特徵，並讓樣本更加一般化。
  
SMOTE 將整個資料集視為輸入，但它僅增加少數案例的百分比。 例如，假設您有一個不平衡的資料集，其中只有 1% 的案例具有目標值 A（少數類），99% 的案例具有值 B。要將少數案例的百分比增加到前一個百分比的兩倍，請在模組的屬性中輸入**200**的**SMOTE 百分比**。  
  
## <a name="examples"></a>範例  

我們建議您嘗試將 SMOTE 用於小型的資料集，藉此了解它的作用為何。 下面的示例使用 Azure 機器學習設計器中可用的獻血資料集。
  
如果將資料集添加到管道並在資料集的輸出上選擇 **"視覺化"，** 則可以看到資料集中的 748 行或案例中，570 個案例（76%）屬於 0 類，178 個案例（24%）為 1 類。 儘管此結果不是非常不平衡的，但類 1 表示獻血者，因此這些行包含要建模*的功能空間*。
 
要增加案例數，可以使用 100 的倍數來設置**SMOTE 百分比**的值，如下所示：

||類別 0|類 1|total|  
|-|-------------|-------------|-----------|  
|原始資料集<br /><br /> （相當於**SMOTE 百分比** = **0**）|570<br /><br /> 76%|178<br /><br /> 24%|748|  
|**SMOTE 百分比** = **100**|570<br /><br /> 62%|356<br /><br /> 38%|926|  
|**SMOTE 百分比** = **200**|570<br /><br /> 52%|534<br /><br /> 48%|1,104|  
|**SMOTE 百分比** = **300**|570<br /><br /> 44%|712<br /><br /> 56%|1,282|  
  
> [!WARNING]
> 使用 SMOTE 增加案例數量不能保證生成更準確的模型。 嘗試使用不同百分比、不同功能集和不同數量的最近鄰居進行管道，以查看添加案例如何影響模型。  
  
## <a name="how-to-configure-smote"></a>如何配置 SMOTE
  
1.  將 SMOTE 模組添加到管道中。 您可以在"**操作"** 類別中找到 **"資料轉換"模組**下的模組。

2. 連接要提升的資料集。 如果要指定用於構建新案例的要素空間，請僅使用特定列或排除某些列，請使用["資料集"模組中的"選擇列](select-columns-in-dataset.md)"。 然後，您可以在使用 SMOTE 之前隔離要使用的列。
  
    否則，通過 SMOTE 創建新案例基於作為輸入提供*的所有*列。 要素列至少有一列是數位。
  
3.  確保選擇了包含標籤或目標類的列。 SMOTE 只接受二進位標籤。
  
4.  SMOTE 模組自動標識標籤列中的少數民族類，然後獲取少數類的所有示例。 所有列不能具有 NaN 值。
  
5.  在**SMOTE 百分比**選項中，輸入指示輸出資料集中少數案例的目標百分比的整數。 例如：  
  
    - 輸入**0**。 SMOTE 模組返回與作為輸入提供的資料集完全相同的資料集。 它沒有增加新的少數案件。 在此資料集中，類比例未更改。  
  
    - 您輸入**100**。 SMOTE 模組生成新的少數案例。 它添加原始資料集中的相同數量的少數民族案例。 由於 SMOTE 不會增加多數案例的數量，因此每個類的案例比例都發生了變化。  
  
    - 您輸入**200**。 與原始資料集相比，該模組將少數案例的百分比加倍。 *這不會*導致少數群體病例數比以前多一倍。 相反，資料集的大小會以這樣表示大多數案例的數量保持不變的方式增加。 少數案例的數量會增加，直到它與所需的百分比值匹配。  
  
    > [!NOTE]
    > SMOTE 百分比僅對 100 的倍數使用。

6.  使用 **"最近鄰域數"** 選項確定 SMOTE 演算法在構建新案例時使用的要素空間的大小。 最近的鄰居是類似于目標大小寫的資料行（案例）。 任兩個案例之間的距離是藉由結合所有功能的加權向量來測量。  
  
    + 通過增加最近鄰域的數量，可以從更多案例中獲取要素。
    + 通過保持最近鄰域的數量較低，可以使用與原始示例中的要素更相同的功能。  
  
7. 如果要確保在同一管道的運行中使用相同的結果（具有相同資料），請在 **"隨機種子"** 框中輸入值。 否則，模組在部署管道時會根據處理器時鐘值生成隨機種子。 生成隨機種子可能會導致運行時的結果略有不同。

8. 提交管道。  
  
   模組的輸出是包含原始行以及許多添加的具有少數情況的行的資料集。  

## <a name="technical-notes"></a>技術說明

+ 發佈使用**SMOTE**模組的模型時，請先從預測管道中刪除**SMOTE，** 然後再將其發佈為 Web 服務。 原因是 SMOTE 旨在改進訓練期間的模型，而不是用於得分。 如果已發佈的預測管道包含 SMOTE 模組，則可能會出錯。

+ 如果在應用 SMOTE 之前清理缺失值或應用其他轉換來修復資料，則通常可以獲得更好的結果。 

+ 一些研究人員已經調查了SMOTE在高維或稀疏資料上是否有效，例如文本分類或基因組資料集中使用的資料。 本文對應用SMOTE在此類情況下的影響和理論有效性進行了很好的總結：[布拉格斯和盧薩：高維類不平衡資料的SMOTE。](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-106)

+ 如果 SMOTE 在資料集中無效，您可能考慮的其他方法包括：
  + 對少數病例進行過採樣或對多數病例進行過採樣的方法。
  + 使用聚類、裝袋或自我調整提升直接説明學員的合奏技術。


## <a name="next-steps"></a>後續步驟

請參閱 Azure 機器學習[可用的模組集](module-reference.md)。 

