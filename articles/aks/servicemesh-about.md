---
title: 關於服務用
description: 獲取服務配置、其體系結構和功能以及選擇要部署的服務配置時應考慮的條件的概述。
author: paulbouwer
ms.topic: article
ms.date: 10/09/2019
ms.author: pabouwer
ms.openlocfilehash: eca49a3fac1ea0398ebe1d05bde20fbca3c81232
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2020
ms.locfileid: "77594306"
---
# <a name="about-service-meshes"></a>關於服務用

服務網格提供流量管理、恢復能力、策略、安全性、強標識和工作負載可觀察性等功能。 應用程式與這些操作功能分離，服務網格將它們移出應用程式層，然後向下移動到基礎結構層。

## <a name="scenarios"></a>案例

以下是在使用服務網格時可以為工作負荷啟用的一些方案：

- **加密群集中的所有流量**- 在群集中的指定服務之間啟用相互 TLS。 這可以擴展到網路週邊的入口和出口。 提供預設安全選項，無需更改應用程式代碼和基礎結構。

- **金絲雀和分階段推出**- 指定要路由到群集中一組新服務的流量子集的條件。 成功測試金絲雀發佈後，刪除條件路由並逐步增加新服務所有流量的百分比。 最終，所有流量將定向到新服務。

- **流量管理和操作**- 創建服務策略，將限制所有流量限制為來自特定源的服務版本。 或將重試策略應用於指定服務之間的故障類的策略。 在遷移或調試問題期間向新版本服務鏡像即時流量。 在測試環境中的服務之間注入故障以測試恢復能力。

- **可觀察性**- 深入瞭解服務如何連接它們之間的流量。 獲取群集中所有流量和入口/入口的指標、日誌和跟蹤。 向應用程式添加分散式跟蹤功能。

## <a name="architecture"></a>架構

服務網格通常由控制平面和資料平面組成。

**控制平面**具有許多支援管理服務網格的元件。 這通常包括一個管理介面，可以是 UI 或 API。 通常也會有管理規則和策略定義的元件，這些元件定義服務網格應如何實現特定功能。 還有一些元件管理安全的各個方面，如 mTLS 的強標識和證書。 服務網通常還具有指標或可觀測性元件，從工作負載收集和聚合指標和遙測資料。

**資料平面**通常由透明地作為副車注入到工作負載的代理組成。 此代理配置為控制包含工作負載的窗格中進出的所有網路流量。 這允許將代理配置為通過 mTLS 保護流量、動態路由流量、對流量應用策略以及收集指標和跟蹤資訊。 

![典型的服務網格架構](media/servicemesh/typical-architecture.png)

## <a name="capabilities"></a>功能

每個服務同項都有天然的適合，並專注于支援特定方案，但您通常會發現，大多數服務都會實現以下許多（如果不是全部）功能。

### <a name="traffic-management"></a>流量管理 

- **協定**= 第 7 層（HTTP，grpc）
- **動態路由**= 條件、加權、鏡像
- **恢復能力**• 超時、重試、斷路器
- **策略**= 存取控制、速率限制、配額
- **測試**- 故障注入

### <a name="security"></a>安全性

- **加密**= mTLS、證書管理、外部 CA
- **強身份**+ SPIFFE 或類似
- **身份驗證**和授權

### <a name="observability"></a>可觀

- **指標**– 黃金指標、普羅米杜斯、格拉法納
- **跟蹤**- 跨工作負載跟蹤
- **流量**= 群集、入口/出口

### <a name="mesh"></a>網狀

- **支援的計算**- 庫伯奈斯，虛擬機器
- **多群集**- 閘道，聯合

## <a name="selection-criteria"></a>選擇標準

在選擇服務網格之前，請確保您瞭解您的要求和安裝服務網格的原因。 請嘗試提出以下問題。

- **入口控制器是否足以滿足我的需求？** - 有時，在入口進行 A/b 測試或流量拆分等功能足以支援所需的方案。 不要為環境增加複雜性，沒有好處。

- **我的工作負載和環境能否承受額外的開銷？** - 支援服務網格所需的所有附加元件都需要額外的資源，如 cpu 和記憶體。 此外，所有代理及其關聯的策略檢查都會增加流量的延遲。 如果工作負荷對延遲非常敏感，或者無法提供其他資源來覆蓋服務網格元件，則重新考慮。

- **這是否不必要地增加了額外的複雜性？** - 如果安裝服務網格的原因是為了獲得對業務或運營團隊不一定至關重要的功能，則請考慮安裝、維護和配置的額外複雜性是否值得。

- **這一點能否以漸進的方式採用？** - 一些提供大量功能的服務用體可以在更增量的方法中採用。 只安裝您需要的元件，以確保您的成功。 一旦你更有信心，需要額外的功能，然後探索這些功能。 抵制從一開始就安裝*所有內容*的衝動。

如果經過仔細考慮後，您決定需要一個服務網格來提供所需的功能，那麼您的下一個決定是*哪個服務網格？*

請考慮以下領域，哪些領域最符合您的要求。 這將指導您實現最適合您的環境和工作負載。 "[後續步驟"](#next-steps)部分將介紹有關特定服務同區及其映射到這些區域的方式的詳細資訊。

- **技術**- 流量管理、政策、安全性、可觀察性

- **商業**- 商業支援、基礎 （CNCF）、OSS 許可證、治理

- **操作**– 安裝/升級、資源要求、性能要求、集成（指標、遙測、儀表板、工具、SMI）、混合工作負載（Linux 和 Windows 節點池）、計算（庫貝內茨、虛擬機器）、多群集

- **安全性**- 身份驗證、標識、證書管理和旋轉、可插拔的外部 CA


## <a name="next-steps"></a>後續步驟

以下文檔提供有關可在 Azure Kubernetes 服務 （AKS） 上試用的服務網的詳細資訊：

> [!div class="nextstepaction"]
> [瞭解更多關於伊斯特奧...][istio-about]

> [!div class="nextstepaction"]
> [瞭解有關連結器 ...][linkerd-about]

> [!div class="nextstepaction"]
> [瞭解更多關於領事...][consul-about]

您可能還希望探索服務網格介面 （SMI），這是庫伯奈斯上服務網格的標準介面：

- [服務網格介面 （SMI）][smi]


<!-- LINKS - external -->
[smi]: https://smi-spec.io/

<!-- LINKS - internal -->
[istio-about]: ./servicemesh-istio-about.md
[linkerd-about]: ./servicemesh-linkerd-about.md
[consul-about]: ./servicemesh-consul-about.md