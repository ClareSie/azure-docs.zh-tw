---
title: 防止意外刪除 - Azure 檔案共用
description: 了解 Azure 檔案共用的虛刪除，以及如何使用其進行資料復原，並防止意外刪除。
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 05/26/2020
ms.author: rogarana
ms.subservice: files
services: storage
ms.openlocfilehash: 96e3d5001d11455337ae092776a1a4c5c3738012
ms.sourcegitcommit: 64fc70f6c145e14d605db0c2a0f407b72401f5eb
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/27/2020
ms.locfileid: "83882931"
---
# <a name="prevent-accidental-deletion-of-azure-file-shares"></a>防止意外刪除 Azure 檔案共用

Azure 儲存體現在提供檔案共用的虛刪除。 虛刪除可讓您在應用程式或其他儲存體帳戶使用者錯誤地刪除您的資料時進行復原。

## <a name="how-soft-delete-works"></a>虛刪除的運作方式

啟用時，虛刪除可讓您在檔案共用遭刪除時加以儲存及復原。 資料刪除後會轉換為虛刪除狀態，而不是永久清除狀態。 您可以設定虛刪除的資料在永久刪除之前可進行復原的時間長度。

可在新的或現有的檔案共用上啟用虛刪除。 虛刪除也具有回溯相容性，如此一來，您不需要對應用程式進行任何變更，即可使用虛刪除的保護。 

對於虛刪除的進階檔案共用，在完全刪除共用的情況下，檔案共用配額 (已佈建的檔案共用大小) 會用於計算儲存體帳戶配額總計，直到虛刪除的共用到期日為止。

### <a name="availability"></a>可用性

Azure 檔案共用的虛刪除適用於所有儲存層、所有儲存體帳戶類型，以及在可提供 Azure 檔案儲存體的每個區域中。

## <a name="configuration-settings"></a>組態設定

檔案共用的虛刪除是在儲存體帳戶層級啟用，虛刪除設定適用於儲存體帳戶內的所有檔案共用。 當您建立新的儲存體帳戶時，虛刪除會預設為關閉。 現有儲存體帳戶的虛刪除也會預設為關閉。 您可以隨時切換開關虛刪除。

如果您啟用檔案共用的虛刪除，請刪除一些檔案共用，然後停用虛刪除，如果已在該期間內儲存共用，您仍然可以存取及復原這些檔案共用。 當您啟用虛刪除時，也需要設定保留期限。

保留期限能指出系統儲存虛刪除檔案共用而可供您復原的時間長度。 對於明確刪除的檔案共用，保留期限時鐘會在資料刪除時啟動。 目前，您可以將虛刪除的共用保留 1 到 365 天。

您可以隨時變更虛刪除保留期限。 更新的保留期間僅適用於在保留期間已更新之後刪除的共用。 保留期間更新之前所刪除的共用，將會在該資料刪除時所設定的保留期間結束後到期。

若要在到期時間之前永久刪除虛刪除狀態的檔案共用，您必須取消刪除該共用、停用虛刪除，然後再次刪除該共用。 然後您應該重新啟用虛刪除，因為該儲存體帳戶中的任何其他檔案共用，在虛刪除關閉時很容易遭到意外刪除。

## <a name="pricing-and-billing"></a>價格和計費

標準和進階檔案共用都會在虛刪除時以已使用的容量計費，而非以佈建的容量計費。 此外，進階檔案共用會以虛刪除狀態中的快照集費率來計費。 標準檔案共用在虛刪除狀態下，會以一般費率計費。 對於在設定的保留期間之後永久刪除的資料，您將不需要付費。

如需 Azure 檔案儲存體一般價格的詳細資訊，請參閱 [Azure 檔案儲存體定價頁面](https://azure.microsoft.com/pricing/details/storage/files/)。

在您首次啟用虛刪除時，建議您使用較小的保留期間，以清楚了解此功能對您的帳單將有何影響。

## <a name="next-steps"></a>後續步驟

若要了解如何啟用及使用虛刪除，請繼續[啟用虛刪除](storage-files-enable-soft-delete.md)