---
title: 教學課程 - 在 Azure IoT Central 中定義新的閘道裝置類型 | Microsoft Docs
description: 本教學課程將為建置者說明如何在 Azure IoT Central 應用程式中定義新的 IoT 閘道裝置類型。
author: rangv
ms.author: rangv
ms.date: 10/22/2019
ms.topic: tutorial
ms.service: iot-central
services: iot-central
ms.custom: mvc
manager: peterpr
ms.openlocfilehash: f95df6fb74071dc16814f11fb48521f984c89778
ms.sourcegitcommit: a43a59e44c14d349d597c3d2fd2bc779989c71d7
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/25/2020
ms.locfileid: "95995517"
---
# <a name="tutorial---define-a-new-iot-gateway-device-type-in-your-azure-iot-central-application"></a>教學課程 - 在 Azure IoT Central 應用程式中定義新的 IoT 閘道裝置類型

*本文適用於解決方案建置人員和裝置開發人員。*

本教學課程將為解決方案建置人員說明如何使用閘道裝置範本，在 IoT Central 應用程式中定義閘道裝置。 接著，您可設定數個下游裝置，以透過閘道裝置連線到您的 IoT Central 應用程式。 

在本教學課程中，您會建立 [智能建築]  閘道裝置範本。 [智能建築]  閘道裝置與其他下游裝置有所關聯。

![閘道裝置與下游裝置之間關聯性的圖表](./media/tutorial-define-gateway-device-type/gatewaypattern.png)

除了讓下游裝置能夠與 IoT Central 應用程式通訊以外，閘道裝置也可以：

* 傳送自己的遙測，例如溫度。
* 回應由操作員所進行的可寫入屬性更新。 例如，操作員可能會變更遙測傳送間隔。
* 回應命令，例如重新啟動裝置。

> [!div class="checklist"]
> 建立下游裝置範本建立閘道裝置範本發佈裝置範本建立模擬裝置

## <a name="prerequisites"></a>Prerequisites

若要完成本教學課程，您必須[建立 Azure IoT Central 應用程式](./quick-deploy-iot-central.md)。

## <a name="create-downstream-device-templates"></a>建立下游裝置範本

本教學課程會使用 [S1 感應器]  裝置和 [RS40 在場感應器]  裝置的裝置範本來產生模擬下游裝置。

若要為 [S1 感應器]  裝置建立裝置範本：

1. 在左窗格中選取 [裝置範本]  。 然後選取 **+** 以開始新增範本。

1. 向下捲動直到您看見 [S1 感應器]  裝置的圖格為止。 選取此圖格，然後選取 **[下一步:** 自訂]。

1. 在 [檢閱]  頁面上，選取 [建立]  以將裝置範本新增到您的應用程式。 

若要為 **_RS40 在場感應器_* 裝置建立裝置範本：

1. 在左窗格中選取 [裝置範本]  。 然後選取 **+** 以開始新增範本。

1. 向下捲動，直到您看見 **_RS40 在場感應器_* 裝置的圖格。 選取此圖格，然後選取 **[下一步:** 自訂]。

1. 在 [檢閱]  頁面上，選取 [建立]  以將裝置範本新增到您的應用程式。 

您現在有適用於這兩種下游裝置的裝置範本：

![下游裝置的裝置範本](./media/tutorial-define-gateway-device-type/downstream-device-types.png)


## <a name="create-a-gateway-device-template"></a>建立閘道裝置範本

在本教學課程中，您會重頭開始建立環境閘道的裝置範本。 您稍後會使用此範本，在您的應用程式中建立模擬閘道裝置。

若要將新的閘道裝置範本新增至應用程式：

1. 在左窗格中選取 [裝置範本]  。 然後選取 **+** 以開始新增範本。

1. 在 [選取範本類型]  頁面上，選取 [IoT 裝置]  圖格，然後選取 [下一步:  自訂]。

1. 在 [自訂裝置]  頁面上，選取 [閘道裝置]  核取方塊。

1. 在 [檢閱]  頁面上，選取 [建立]  。 

1. 輸入「智能建築閘道裝置」  作為範本名稱。

1. 在 [建立功能模型]  頁面上，選取 [自訂]  圖格。

1. 選取 **+** 以新增介面。  新增 [裝置資訊]  標準介面。

### <a name="add-relationships"></a>新增關聯性

接下來，您會將關聯性新增到下游裝置的範本：

1. 在 [智能建築閘道裝置]  範本中，選取 [關聯性]  。

1. 選取 [+ 新增關聯性]  。 輸入 [環境感應器]  作為顯示名稱，然後選取 [S1 感應器]  作為目標。

1. 再次選取 [+ 新增關聯性]  。 輸入 [在場感應器]  作為顯示名稱，然後選取 [RS40 在場感應器]  作為目標。

1. 選取 [儲存]  。

![智能建築閘道裝置範本 (顯示關聯性)](./media/tutorial-define-gateway-device-type/relationships.png)

### <a name="add-cloud-properties"></a>新增雲端屬性

閘道裝置範本可包含雲端屬性。 雲端屬性僅存在於 IoT Central 應用程式中，且一律不會傳送至或接收自裝置。

若要將雲端屬性新增至 [智能建築閘道裝置]  範本：

1. 在 [智能建築閘道裝置]  範本中，選取 [雲端屬性]  。

1.  請使用下表中的資訊，將兩個雲端屬性新增至您的閘道裝置範本。

    | 顯示名稱      | 語意類型 | 結構描述 |
    | ----------------- | ------------- | ------ |
    | 上次維修日期 | None          | Date   |
    | 客戶名稱     | None          | String |

2. 選取 [儲存]  。

### <a name="create-views"></a>建立檢視

身為建置者，您可以自訂應用程式，以對操作員顯示環境感應器裝置的相關資訊。 您的自訂將使操作員能夠管理已連線至應用程式的環境感應器裝置。 您可以建立兩種類型的檢視，讓操作員用來與裝置互動：

* 用於檢視及編輯裝置和雲端屬性的表單。
* 用來將裝置視覺化的儀表板。

若要產生 [智能建築閘道裝置]  範本的預設檢視：

1. 在 [智能建築閘道裝置]  範本中，選取 [檢視]  。

1. 選取 [產生預設檢視]  圖格，並確定已選取所有的選項。

1. 選取 [產生預設儀表板檢視]  。

## <a name="publish-the-device-template"></a>發佈裝置範本

您必須先發佈裝置範本，才能建立模擬閘道裝置，或連線實際的閘道裝置。

若要發佈閘道裝置範本：

1. 從 [裝置範本]  頁面中選取 [智能建築閘道裝置]  範本。

2. 選取 [發佈]  。

3. 在 [發佈裝置範本]  對話方塊中，選擇 [發佈]  。

裝置範本發佈後，將會顯示在 [裝置]  頁面上，並且對操作員顯示。 在已發佈的裝置範本中，您無法直接編輯裝置模型而不建立新版本。 不過，您可以直接在已發佈的裝置範本中更新雲端屬性、自訂和檢視。 這些更新不會導致新版本建立。 進行任何變更之後，請選取 [發佈]  ，將這些變更推送給您的操作員。

## <a name="create-the-simulated-devices"></a>建立模擬裝置

本教學課程會使用模擬下游裝置和模擬閘道裝置。

若要建立模擬閘道裝置：

1. 在 [裝置]  頁面上，選取裝置範本清單中的 [智能建築閘道裝置]  。

1. 選取 **+** 以開始新增裝置。

1. 保留所產生的 [裝置識別碼]  和 [裝置名稱]  。 確定 [模擬]  切換開關為 [開啟]  。 選取 [建立]  。

若要建立模擬下游裝置：

1. 在 [裝置]  頁面上，選取裝置範本清單中的 [RS40 在場感應器]  。

1. 選取 **+** 以開始新增裝置。

1. 保留所產生的 [裝置識別碼]  和 [裝置名稱]  。 確定 [模擬]  切換開關為 [開啟]  。 選取 [建立]  。

1. 在 [裝置]  頁面上，選取裝置範本清單中的 [R1 感應器]  。

1. 選取 **+** 以開始新增裝置。

1. 保留所產生的 [裝置識別碼]  和 [裝置名稱]  。 確定 [模擬]  切換開關為 [開啟]  。 選取 [建立]  。

![您應用程式中的模擬裝置](./media/tutorial-define-gateway-device-type/simulated-devices.png)

### <a name="add-downstream-device-relationships-to-a-gateway-device"></a>將下游裝置關聯性新增至閘道裝置

既然您的應用程式中有模擬裝置，您就可以在下游裝置與閘道裝置之間建立關聯性：

1. 在 [裝置]  頁面上，選取裝置範本清單中的 [S1 感應器]  ，然後選取您的模擬 [S1 感應器]  裝置。

1. 選取 [連線到閘道]  。

1. 在 [連線到閘道]  對話方塊中，選取 [智能建築閘道裝置]  範本，然後選取您先前建立的模擬執行個體。

1. 選取 [加入]  。

1. 在 [裝置]  頁面上，選取裝置範本清單中的 [RS40 在場感應器]  ，然後選取您的模擬 [RS40 在場感應器]  裝置。

1. 選取 [連線到閘道]  。

1. 在 [連線到閘道]  對話方塊中，選取 [智能建築閘道裝置]  範本，然後選取您先前建立的模擬執行個體。

1. 選取 [加入]  。

您的模擬下游裝置現在已連線到您的模擬閘道裝置。 如果您瀏覽至閘道裝置的 [下游裝置]  檢視，您可以看到相關的下游裝置：

![下游裝置檢視](./media/tutorial-define-gateway-device-type/downstream-device-view.png)

選取閘道裝置範本和閘道裝置執行個體，然後選取 [聯結]  。

## <a name="next-steps"></a>後續步驟

在本教學課程中，您已了解如何：

* 將新的 IoT 閘道建立為裝置範本。
* 建立雲端屬性。
* 建立自訂。
* 定義裝置遙測的視覺效果。
* 新增關聯性。
* 發佈您的裝置範本。

> [!NOTE]
> 在 IoT Central 中模型化的閘道裝置目前不支援以 VS Code 為基礎的程式碼產生。

接著，身為裝置開發人員，您可以了解如何：

> [!div class="nextstepaction"]
> [將 Azure IoT Edge 裝置新增至 Azure IoT Central 應用程式](tutorial-add-edge-as-leaf-device.md)
