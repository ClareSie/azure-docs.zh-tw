---
title: 將資料分組成 Bin
titleSuffix: Azure Machine Learning
description: 了解如何使用「將資料分組成 Bin」模組來將數值分組，或變更連續資料的散發。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 05/19/2020
ms.openlocfilehash: b33aa3d2ab22fc986100d6141dd03d5547ef1862
ms.sourcegitcommit: 1f25aa993c38b37472cf8a0359bc6f0bf97b6784
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/26/2020
ms.locfileid: "83853730"
---
# <a name="group-data-into-bins"></a>將資料分組成 Bin

本文說明如何在 Azure Machine Learning 設計工具 (預覽) 中使用[將資料分組成 Bin](group-data-into-bins.md) 模組，以將數值分組，或變更連續資料的散發。

[將資料分組成 Bin](group-data-into-bins.md)模組支援量化資料的多個選項。 您可以自訂量化邊緣的設定方式，以及如何將值分配到 Bin 中。例如，您可以：  

+ 手動輸入一系列值作為 Bin 界限。  
+ 使用「分位數」或百分位數排名，將值指派給 Bin。  
+ 強制將值平均散發至 Bin。  

### <a name="more-about-binning-and-grouping"></a>深入了解量化和群組

「量化 (Binning)」 或群組資料 (有時稱為「量化 (Quantization)」) 是針對機器學習準備數值資料的重要工具，而且在如下的案例中很有用：

+ 連續數值的資料行有太多唯一值可有效率地進行模型化，因此您可以自動或手動將值指派給群組，以建立較小的離散範圍集。

+ 以代表特定範圍的類別值來取代數值的資料行。

    例如，您可能想要藉由指定自訂範圍 (例如，1-15、16-22、23-30 等等) 來將年齡資料行中的值群組在一起，以取得使用者人口統計。

+ 資料集有幾個極端的值，全都在預期的範圍外，而這些值對定型的模型有巨大影響。 若要減輕模型中的偏差，您可以使用分位數方法，將資料轉換成統一的散發。

    使用此方法時，[將資料分組成 Bin](group-data-into-bins.md) 模組會決定理想的 Bin 位置和 Bin 寬度，以確保大約相同數目的樣本落在每個 Bin 中。 然後，根據您選擇的正規化方法，會將 Bin 中的值轉換成百分位數或對應到 Bin 數值。

### <a name="examples-of-binning"></a>量化的範例

下圖顯示使用**分位數**方法進行量化前後，數值的分佈。 請注意，相較於左側的未經處理資料，資料已經過量化並轉換成一般單位的規模。  

「您可以從這個管線執行的結果找到範例： https://ml.azure.com/visualinterface/authoring/Normal/87270db9-4651-448e-bd28-8ef7428084dc?wsid=%2Fsubscriptions%2Fe9b2ec51-5c94-4fa8-809a-dc1e695e4896%2Fresourcegroups%2Fmodule-ws-rg%2Fworkspaces%2Fmodule-prerelease-119&flight=cm&tid=72f988bf-86f1-41af-91ab-2d7cd011db47&smtendpoint=https%3A%2F%2Fsmt-test1.azureml-test.net 」

因為有這麼多的方式可將資料分組，而且全部都可以自訂，所以我們建議您試驗不同的方法和值。 

## <a name="how-to-configure-group-data-into-bins"></a>如何設定將資料分組成 Bin

1. 在「設計工具」(預覽) 中新增**將資料分組成 Bin** 模組至您的管線。 您可以在 [資料轉換] 類別中找到此模組。

2. 將具有數值資料的資料集連線到 Bin。  量化只能套用至包含數值資料的資料行。 

    如果資料集包含非數值的資料行，請使用[選取資料集中的資料行](select-columns-in-dataset.md)模組，選取要使用的資料行子集。

3. 指定量化模式。 量化模式會決定其他參數，因此請務必先選取 [量化模式] 選項。 支援下列類型的量化：

    **分位數**：分位數方法會依據百分位等級，將值指派至分類收納。 分位數也稱為等高量化。

    **等寬**：使用此選項時，您必須指定 Bin 的數目總計。資料資料行中的值會放入 Bin，使得各個 Bin 都有開始值和結束值之間的相同間隔。 如此一來，如果資料聚集在特定點周圍，某些分類收納可能會更多值。

    **自訂邊緣**：您可以指定每個 Bin 開頭的值。 邊緣值一律是 Bin 的下限。  例如，假設您想要將值分組成兩個 Bin，其中一個的值大於0，另一個的值小於或等於 0。 在此情況下，對於量化邊緣，您會在**量化邊緣的逗號分隔清單**中輸入 0。 模組的輸出會是 1 和 2，表示每個資料列值的 Bin 索引。 請注意，逗號分隔值清單必須以遞增順序排序，例如 1、3、5、7。

4. **Bin 的數目**：如果您使用**分位數**和**等寬**量化模式，請使用此選項來指定您要建立多少 Bin，或您想要建立的「分位數」。

5. 針對 [要量化的資料行]，使用資料行選取器來選擇含有您要量化值的資料行。 資料行必須是數值資料類型。

    相同的量化規則會套用到您選擇的所有適用資料行。 因此，如果您需要使用不同方法來量化一些資料行，請針對每個資料行集，使用個別的[將資料分組成 Bin](group-data-into-bins.md) 執行個體。

    > [!WARNING]
    > 如果您選擇的資料行不是允許的類型，則會產生執行階段錯誤。 當模組找到不允許類型的任何資料行時，就會傳回錯誤。 如果您收到錯誤，請檢閱所有選取的資料行。 此錯誤不會列出所有無效的資料行。

6. 針對**輸出模式**，指出您要如何輸出量化值。

      + **Append**：使用已量化的值來建立新資料行，並將該資料行附加至輸入資料表。

      + **Inplace**：以資料集中的新值取代原始值。

      + **ResultOnly**：只傳回結果資料行。

7. 如果您選取 [分位數] 量化模式，請使用 [分位數正規化] 選項，以決定在排序為分位數之前如何將值正規化。 請注意，將值正規化會轉換值，但是不會影響最終的 Bin 數目。

    支援下列正規化類型：

    + **Percent**：值會在範圍 [0,100] 中正規化

    + **PQuantile**：值會在範圍 [0,1] 中正規化

    + **QuantileIndex**：值會在範圍 [1,Bin 的數目] 中正規化

8. 如果您選擇 [自訂邊緣] 選項，請在 + [量化邊緣的逗號分隔清單] 文字方塊中，輸入以逗號分隔的數值清單，作為「量化邊緣」。  這些值會標示分割 Bin 的點，因此，如果您輸入一個量化邊緣值，則會產生兩個 Bin；如果您輸入兩個量化邊緣值，則會產生三個 Bin，依此類推。

    必須以分類收納的建立順序來將值排序，從最低到最高。

10. **將資料行標記為類別**：選取此選項，指出應該將量化資料行當做類別變數來處理。

11. 提交管線。

### <a name="results"></a>結果

[將資料分組成 Bin](group-data-into-bins.md) 模組會傳回資料集，其中的每個元素均根據指定的模式量化。 

其也會傳回**量化轉換**，這是一個函式，可以傳遞至[套用轉換](apply-transformation.md)模組，以使用相同的量化模式和參數來將新的資料範例量化。  

> [!TIP]
> 請記住，如果您在定型資料上使用量化，就必須在用於測試和預測的資料上使用相同的量化方法。 這包括量化方法、Bin 位置和 Bin 寬度。 
> 
> 若要確保一律使用相同的量化方法來轉換資料，建議您儲存有用的資料轉換，然後使用[套用轉換](apply-transformation.md)模組，將其套用至其他資料集。

## <a name="next-steps"></a>後續步驟

請參閱 Azure Machine Learning 的[可用模組集](module-reference.md)。 
