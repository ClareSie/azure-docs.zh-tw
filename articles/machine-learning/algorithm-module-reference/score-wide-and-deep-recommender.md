---
title: 映像計分模型
titleSuffix: Azure Machine Learning
description: 瞭解如何在 Azure Machine Learning 中使用 & Deep 推薦模組的分數範圍，以評分資料集的建議預測。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 06/12/2020
ms.openlocfilehash: 1d566d270f9e4b7017171a79fddf58090e21cdec
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/02/2020
ms.locfileid: "84739799"
---
# <a name="score-wide-and-deep-recommender"></a>廣泛評分和深度推薦

本文說明如何使用 Azure Machine Learning 設計工具（預覽）中的「**分數寬」和「深度推薦**」模組，根據來自 Google 的寬 & 深度學習，根據定型的建議模型來建立預測。

寬和深度推薦可以產生兩種不同類型的預測：

- [為指定使用者和項目預測評等](#predict-ratings)

- [對指定使用者推薦項目](#recommend-items)


建立這類的預測時，您可以在*生產模式*或*評估模式下*操作。

- **生產模式**會考慮所有使用者或專案，而且通常用於 web 服務。 您可以為新的使用者建立分數，而不只是在訓練期間看到的使用者。 

- **評估模式**會在一組精簡的使用者或可評估的專案上運作，而且通常會在實驗期間使用。

如需有關寬和深度推薦及其基礎理論的詳細資訊，請參閱相關的研究檔：[適用于推薦系統的寬 & 深度學習](https://arxiv.org/pdf/1606.07792.pdf)。  

## <a name="how-to-configure-score-wide-and-deep-recommender"></a>如何設定分數範圍和深度推薦

此模組支援不同類型的建議，各有不同的需求。 針對您所擁有的資料類型，以及您想要建立的建議類型，按一下連結。

+ [預測評等](#predict-ratings)
+ [建議專案](#recommend-items)

### <a name="predict-ratings"></a>預測評等

當您預測評等時，模型會計算指定的使用者將如何回應特定的專案（給定定型資料）。 因此，計分的輸入資料必須同時提供使用者和專案進行評分。

1. 將已定型的寬 & 深入建議模型新增至您的實驗，並將其連線至已**定型的寬和深度建議模型**。  您必須使用 [[整個訓練] 和 [深度推薦](train-wide-and-deep-recommender.md)] 來建立模型。

2. **推薦預測種類**：選取 [**評等預測**]。 不需要更多的參數。

3. 加入您想要進行預測的資料，並將其連接至**資料集以進行評分**。

    若要預測評等，輸入資料集必須包含使用者-專案配對。

    資料集可以在第一個和第二個數據行中包含使用者-專案組的選擇性第三個評等資料行，但是在預測期間將會忽略第三個數據行。

4.  (選擇性)。 如果您有使用者功能的資料集，請將其連接到**使用者功能**。

    使用者特徵的資料集應該包含第一欄中的使用者識別碼。 其餘的資料行應該包含可描述使用者的值，例如其性別、喜好設定、位置等。
  
    **分數寬和深度推薦**會忽略在訓練資料集中評等專案的使用者功能，因為它們已在定型期間學習。 因此，請事先篩選您的資料集，只包含*冷啟動的使用者*，或是未分級任何專案的使用者。

    > [!WARNING]
    > 如果模型是在未使用使用者功能的情況下定型，您就無法在計分期間引進使用者功能。

5. 如果您有專案功能的資料集，您可以將它連接到**專案功能**。

    專案功能資料集必須在第一欄中包含專案識別碼。 其餘的資料行應該包含用來描述專案的值。

    **分數寬和深度推薦**會忽略訓練資料集中評等專案的特徵，因為在定型期間已經學習到這些功能。 因此，請將您的評分資料集限制為*冷啟動專案*，或將未由任何使用者評分的專案。

    > [!WARNING]
    > 如果模型未使用專案特徵而定型，您就無法在計分期間引進專案功能。

7. 執行實驗。

### <a name="results-for-rating-predictions"></a>評等預測的結果 

輸出資料集包含三個數據行，其中包含使用者、專案，以及每個輸入使用者和專案的預測評等。

此外，評分期間也會套用下列變更：

-  若為數值使用者或專案特徵資料行，則會自動將遺漏值取代為其非遺漏定型集值的**平均值**。 針對分類功能，會以此功能的任何可能值以外的相同類別值來取代遺漏值。
-  不會將任何翻譯套用至功能值，以維護其稀疏性。

### <a name="recommend-items"></a>建議專案

若要為使用者建議專案，您可以提供使用者和專案的清單做為輸入。 在此資料中，模型會使用其現有專案和使用者的知識，來產生可能吸引每位使用者的專案清單。 您可以自訂傳回的建議數目，並為產生建議所需的先前建議數目設定閾值。

1. 將定型的寬和深度建議模型新增至您的實驗，並將其連線至已**定型的寬和深度建議模型**。  您必須使用 [[整個訓練] 和 [深度推薦](train-wide-and-deep-recommender.md)] 來建立模型。

2. 若要針對指定的使用者清單建議專案，請將**推薦預測種類**設定為**專案建議**。

3. **建議的專案選取**：請選擇下列其中一個值，指出您是在生產環境中使用計分模組，還是要進行模型評估：

    - **從評等專案（針對模型評估）**：如果您正在開發或測試模型，請選取此選項。 此選項會啟用**評估模式**，而此模組只會從已評等之輸入資料集中的專案提出建議。
    - **從所有專案**：如果您要設定要在 Web 服務或生產環境中使用的實驗，請選取此選項。  此選項會啟用 [**生產] 模式**，而模組會從定型期間看到的所有專案提出建議。
    - **從未分級的專案（為使用者建議新的專案）**：如果您想要模組僅針對訓練資料集中尚未分級的專案提出建議，請選取此選項。 
4. 加入您要進行預測的資料集，並將它連接至**資料集以進行評分**。

    - 如果您選擇 [**從所有專案**] 選項，則輸入資料集應包含一個或唯一一個資料行，其中包含要做建議的使用者識別碼。

        此資料集可以包含專案識別碼和評等的額外兩個數據行，但會忽略這兩個數據行。 

    - 如果您選擇 [**從評等專案（針對模型評估）**] 選項，則輸入資料集會包含**使用者-專案配對**。 第一個資料行應該包含**使用者**識別碼。 第二個數據行應該包含對應的**專案**識別碼。

        此資料集可以包含使用者-專案評等的第三個數據行，但會忽略此資料行。
        
    - **若為來自未分級的專案（向使用者建議新專案）**，輸入資料集應由使用者-專案配對所組成。 第一個資料行應該包含使用者識別碼。 第二個數據行應該包含對應的專案識別碼。

        此資料集可以包含使用者-專案評等的第三個數據行，但會忽略此資料行。

5. (選擇性)。 如果您有**使用者功能**的資料集，請將其連接到**使用者功能**。

    使用者功能資料集中的第一個資料行應該包含使用者識別碼。 其餘的資料行應該包含可描述使用者的值，例如其性別、喜好設定、位置等。

    **分數寬和深度推薦**會忽略已評等專案之使用者的功能，因為在定型期間已瞭解這些功能。 因此，您可以事先篩選資料集，只包含*冷啟動的使用者*，或是未分級任何專案的使用者。

    > [!WARNING]
    >  如果模型是在未使用使用者功能的情況下定型，您就無法在評分期間使用 [套用功能]。

6. 選擇性如果您有**專案功能**的資料集，您可以將它連接到**專案功能**。

    專案功能資料集內的第一個資料行必須包含專案識別碼。 其餘的資料行應該包含用來描述專案的值。

    **分數寬和深度推薦**會忽略已評等專案的功能，因為在定型期間已瞭解這些功能。 因此，您可以將評分資料集限制為*冷啟動專案*，或未由任何使用者評分的專案。

    > [!WARNING]
    >  如果模型未使用專案特徵而定型，請勿在評分時使用專案功能。  

7. **要建議給使用者的專案數上限**：輸入要為每個使用者傳回的專案數。 根據預設，建議使用5個專案。

8. **每位使用者的建議集區大小下限**：輸入一個值，指出需要多少先前的建議。  根據預設，此參數設定為2，表示專案必須至少由兩個其他使用者建議。

    只有當您在評估模式中進行評分時，才應該使用此選項。 如果您**從 [所有專案**] 或 [未分級的專案] 中選取，則無法使用此選項 **（向使用者建議新專案）**。

9. 若為**來自未分級的專案（向使用者建議新專案）**，請使用名為**定型資料**的第三個輸入埠，從預測結果中移除已評分的專案。

    若要套用此篩選，請將原始訓練資料集連接到輸入埠。

10. 執行實驗。
### <a name="results-of-item-recommendation"></a>專案建議的結果

**分數寬和深度推薦**所傳回的評分資料集會列出每個使用者的建議專案。

- 第一個資料行包含使用者識別碼。
- 會產生一些額外的資料行，這取決於您為**建議給使用者的專案數上限**而設定的值。 每個資料行都包含建議的專案（依識別碼）。 這些建議會依使用者專案親和性排序，而具有最高親和性的專案會放在 [**專案 1**] 資料行中。

> [!WARNING]
> 無法使用[評估推薦](evaluate-recommender.md)模組來評估此計分資料集。

##  <a name="technical-notes"></a>技術說明

本節包含有關使用 Wide & 深層推薦來建立預測的一些常見問題解答。  

###  <a name="cold-start-users-and-recommendations"></a>冷啟動使用者和建議

一般而言，若要建立建議，「**分數寬」和「深度推薦**」模組需要與您在定型模型時使用的相同輸入，包括使用者識別碼。 這是因為演算法需要知道它是否已在定型期間瞭解此使用者的相關資訊。 

不過，對於新的使用者，您可能沒有使用者識別碼，只有一些使用者功能，例如年齡、性別等等。

您仍然可以為系統很陌生的使用者建立建議，方法是將他們視為*冷啟動使用者*來處理。 對於這類使用者，建議演算法不會使用過去的歷程記錄或先前的評等，只會使用使用者特徵。

基於預測的目的，冷啟動使用者會定義為識別碼尚未用於定型的使用者。 若要確保識別碼不符合定型中使用的 Id，您可以建立新的識別碼。 例如，您可能會在指定的範圍內產生隨機識別碼，或是預先針對冷啟動使用者配置一系列的識別碼。

不過，如果您沒有任何共同作業的篩選資料 (例如使用者特徵的向量)，您最好使用分類或迴歸學習因子。

###  <a name="production-use-of-the-wide-and-deep-recommender"></a>廣泛和深度推薦的生產環境使用

如果您已實驗寬和深度推薦，然後將模型移至生產環境，在評估模式和生產模式中使用推薦時，請留意這些主要差異：

- 根據定義，評估需要可在測試集中進行*地真*驗證的預測。 因此，當您評估推薦時，它必須只預測已在測試集中評等的項目。 這一定會限制預測的可能值。

    不過，當您作業化模型時，通常會變更預測模式，根據所有可能的項目提出建議，以取得最佳預測。 這其中許多預測都沒有相對應的事實，因此無法以實驗期間的相同方式驗證建議的精確度。

- 如果您未在運作中提供使用者識別碼，只提供特徵向量，您可能會得到所有可能使用者的所有建議清單做為回應。 請務必提供使用者識別碼。

    若要限制傳回的建議數目，您也可以指定每個使用者傳回的項目數上限。 



## <a name="next-steps"></a>後續步驟

請參閱 Azure Machine Learning[可用的模組集合](module-reference.md)。 
