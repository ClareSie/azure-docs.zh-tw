---
title: 在 Azure IoT Central 中定義新的 IoT 裝置類型 | Microsoft Docs
description: 本文說明如何在您的 Azure IoT Central 應用程式中建立新的 Azure IoT 裝置範本，作為建立者。 您會定義該類型的遙測、狀態、屬性和命令。
author: dominicbetts
ms.author: dobett
ms.date: 12/06/2019
ms.topic: how-to
ms.service: iot-central
services: iot-central
ms.custom:
- contperfq1
- device-developer
ms.openlocfilehash: aa70c9e5d67c759afe905e9e110d6bcd18555a8c
ms.sourcegitcommit: 43558caf1f3917f0c535ae0bf7ce7fe4723391f9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/11/2020
ms.locfileid: "90019235"
---
# <a name="define-a-new-iot-device-type-in-your-azure-iot-central-application"></a>在 Azure IoT Central 應用程式中定義新的 IoT 裝置類型

*本文適用於解決方案建置人員和裝置開發人員。*

裝置範本是一種藍圖，可定義連接至 [Azure IoT Central 應用程式](concepts-app-templates.md)之裝置類型的特性和行為。

例如，建置者可以為連線的風扇建立具有下列特性的裝置範本：

- 傳送溫度遙測資料
- 傳送位置屬性
- 傳送風扇馬達錯誤事件
- 傳送風扇運轉狀態
- 提供可寫入的風扇速度屬性
- 提供用來重新啟動裝置的命令
- 透過儀表板為您提供裝置的整體檢視

透過此裝置範本，操作員可以建立並連接實際的風扇裝置。 這些風扇全都會有量值、屬性和命令，可供操作員用來監視和管理風扇。 操作員可以使用 [裝置儀表板](#add-dashboards) 和表單來與風扇裝置互動。 裝置開發人員會使用此範本來瞭解裝置與應用程式的互動方式。 若要深入瞭解，請參閱 [遙測、屬性和命令](concepts-telemetry-properties-commands.md)承載。

> [!NOTE]
> 只有建置者和系統管理員可以建立、編輯和刪除裝置範本。 任何使用者都可以在 [裝置]**** 頁面上，透過現有裝置範本來建立裝置。

在 IoT Central 應用程式中，裝置範本會使用裝置功能模型來描述裝置的功能。 身為建置者，您可以利用數個選項來建立裝置範本：

- 在 IoT Central 中設計裝置範本，然後 [在您的裝置程式碼中執行其裝置功能模型](concepts-telemetry-properties-commands.md)。
- 從 [Azure IoT 認證裝置目錄](https://aka.ms/iotdevcat)匯入裝置功能模型。 然後，新增 IoT Central 應用程式所需的任何雲端屬性、自訂項目和儀表板。
- 使用 Visual Studio Code 建立裝置功能模型。 從模型實作您的裝置程式碼。 手動將裝置功能模型匯入您的 IoT Central 應用程式中，然後新增您的 IoT Central 應用程式所需的任何雲端屬性、自訂和儀表板。
- 使用 Visual Studio Code 建立裝置功能模型。 從模型實作裝置程式碼，並使用裝置優先連線將實際的裝置連線至 IoT Central 應用程式。 IoT Central 會從公用存放庫中為您尋找並匯入裝置功能模型。 然後，您便可以將 IoT Central 應用程式所需的任何雲端屬性、自訂和儀表板新增至裝置範本中。

您也可以使用 [REST API](https://docs.microsoft.com/learn/modules/manage-iot-central-apps-with-rest-api/) 或 [CLI](howto-manage-iot-central-from-cli.md)將裝置範本新增至 IoT Central 應用程式。

某些 [應用程式範本](concepts-app-templates.md) 已包含在應用程式範本支援的案例中很有用的裝置範本。 例如，請參閱 [店內分析架構](../retail/store-analytics-architecture.md)。

## <a name="create-a-device-template-from-the-device-catalog"></a>從裝置目錄建立裝置範本

身為建置者，您可以使用 IoT 隨插即用 (預覽) 認證裝置，快速地開始打造解決方案。 請參閱 [Azure IoT 裝置目錄](https://catalog.azureiotsolutions.com/alldevices)中的清單。 IoT Central 會與裝置目錄整合，以便從這些 IoT 隨插即用 (預覽) 認證裝置匯入裝置功能模型。 若要在 IoT Central 中，從其中一個裝置建立裝置範本：

1. 移至 IoT Central 應用程式中的 [裝置範本]**** 頁面。
1. 選取 [+ 新增]****，然後從目錄中選取任何一個 IoT 隨插即用 (預覽) 認證裝置。 IoT Central 會根據這個裝置功能模型來建立裝置範本。
1. 將任何雲端屬性、自訂或檢視新增至裝置範本。
1. 選取 [發佈]****，讓範本可供操作員用來檢視及連接裝置。

## <a name="create-a-device-template-from-scratch"></a>從頭開始建立裝置範本

裝置範本包含：

- 「裝置功能模型」__，可指定裝置所實作的遙測、屬性和命令。 這些功能會組織成一或多個介面。
- 「雲端屬性」__，可定義 IoT Central 應用程式所儲存的裝置相關資訊。 例如，雲端屬性可記錄上次服務裝置的日期。 此資訊一律不會與裝置共用。
- 「自訂」__，可讓建置者覆寫裝置功能模型中的某些定義。 例如，建置者可覆寫裝置屬性的名稱。 屬性名稱會出現在 IoT Central 的儀表板和表單中。
- 「儀表板和表單」__，可讓建置者建立 UI，而讓操作員能夠監視和管理與應用程式連線的裝置。

若要在 IoT Central 中建立裝置範本：

1. 移至 IoT Central 應用程式中的 [裝置範本]**** 頁面。
1. 選取 [ **+ 新增**  >  **自訂**]。
1. 輸入範本的名稱，例如**環境感應器**。
1. 按 **Enter**。 IoT Central 便會建立空白的裝置範本。

## <a name="manage-a-device-template"></a>管理裝置範本

您可以從範本的首頁重新命名或刪除範本。

將裝置功能模型新增至範本後，就可以將其發佈。 直到發佈範本後，您才能根據此範本連接裝置，從而讓操作員得以在 [裝置]**** 頁面中看到裝置。

## <a name="create-a-capability-model"></a>建立功能模型

若要建立裝置功能模型，您可以：

- 使用 IoT Central 從頭開始建立自訂模型。
- 從 JSON 檔案匯入模型。 裝置建置者可能已使用 Visual Studio Code 來撰寫適用於應用程式的裝置功能模型。
- 從裝置目錄中選取其中一個裝置。 此選項會匯入製造商為此裝置發佈的裝置功能模型。 以這種方式匯入的裝置功能模型會自動發佈。

## <a name="manage-a-capability-model"></a>管理功能模型

建立裝置功能模型之後，您可以：

- 將介面新增至模型。 模型必須至少有一個介面。
- 編輯模型中繼資料，例如其識別碼、命名空間和名稱。
- 刪除模型。

## <a name="create-an-interface"></a>建立介面

裝置功能必須至少有一個介面。 介面是可重複使用的功能集合。

若要建立介面：

1. 移至您的裝置功能模型，然後選擇 [ **+ 新增介面**]。

1. 在 [選取介面]**** 頁面上，您可以：

    - 從頭開始建立自訂介面。
    - 從檔案匯入現有介面。 裝置建置者可能已使用 Visual Studio Code 來撰寫適用於裝置的介面。
    - 選擇其中一個標準介面，例如 **裝置資訊** 介面。 標準介面會指定許多裝置通用的功能。 這些標準介面是由 Azure IoT 發佈的，您無法對其設定版本或進行編輯。

1. 在建立介面之後，請選擇 [編輯身分識別]**** 來變更介面的顯示名稱。

1. 如果您選擇從頭開始建立自訂介面，則可以新增裝置的功能。 裝置功能包括遙測、屬性和命令。

### <a name="telemetry"></a>遙測

遙測是裝置所傳送過來的數值串流，來源一般是感應器。 例如，感應器可以報告周圍溫度。

下表顯示遙測功能的組態設定：

| 欄位 | 描述 |
| ----- | ----------- |
| 顯示名稱 | 儀表板和表單上所用遙測值的顯示名稱。 |
| Name | 遙測訊息中的欄位名稱。 IoT Central 會從顯示名稱產生此欄位的值，但如有必要，您也可以選擇自己所要使用的值。 此欄位必須是英數位元。 |
| 功能類型 | 遙測。 |
| 語意類型 | 遙測的語意類型，例如溫度、狀態或事件。 所選擇的語意類型會決定下列哪些欄位可供使用。 |
| 結構描述 | 遙測的資料類型，例如雙精度浮點數、字串或向量。 可用的選項取決於語意類型。 結構描述不適用於事件和狀態這兩種語意類型。 |
| Severity | 僅適用於事件語意類型。 嚴重性為 [錯誤]****、[資訊]**** 或 [警告]****。 |
| 狀態值 | 僅適用於狀態語意類型。 會定義可能的狀態值，每個狀態值都會有顯示名稱、名稱、列舉類型和值。 |
| 單位 | 遙測值的單位，例如 **>mph**、 **%** 或** &deg; C**。 |
| 顯示單位 | 要在儀表板和表單上使用的顯示單位。 |
| 註解 | 遙測功能的任何相關註解。 |
| 描述 | 遙測功能的說明。 |

### <a name="properties"></a>屬性

屬性代表時間點值。 例如，裝置可以使用屬性來報告其嘗試到達的目標溫度。 您可以從 IoT Central 設定可寫入的屬性。

下表顯示屬性功能的組態設定：

| 欄位 | 描述 |
| ----- | ----------- |
| 顯示名稱 | 儀表板和表單上所用屬性值的顯示名稱。 |
| Name | 屬性的名稱。 IoT Central 會從顯示名稱產生此欄位的值，但如有必要，您也可以選擇自己所要使用的值。 此欄位必須是英數位元。 |
| 功能類型 | 屬性。 |
| 語意類型 | 屬性的語意類型，例如溫度、狀態或事件。 所選擇的語意類型會決定下列哪些欄位可供使用。 |
| 結構描述 | 屬性的資料類型，例如雙精度浮點數、字串或向量。 可用的選項取決於語意類型。 結構描述不適用於事件和狀態這兩種語意類型。 |
| 可寫入 | 如果屬性無法寫入，裝置可以向 IoT Central 報告屬性值。 如果屬性可寫入，則裝置可以向 IoT Central 報告屬性值，IoT Central 也可以向裝置傳送屬性更新。
| Severity | 僅適用於事件語意類型。 嚴重性為 [錯誤]****、[資訊]**** 或 [警告]****。 |
| 狀態值 | 僅適用於狀態語意類型。 會定義可能的狀態值，每個狀態值都會有顯示名稱、名稱、列舉類型和值。 |
| 單位 | 屬性值的單位，例如 **>mph**、 **%** 或** &deg; C**。 |
| 顯示單位 | 要在儀表板和表單上使用的顯示單位。 |
| 註解 | 屬性功能的任何相關註解。 |
| 描述 | 屬性功能的說明。 |

### <a name="commands"></a>命令

您可以從 IoT Central 呼叫裝置命令。 命令會選擇性地將參數傳遞給裝置，並接收裝置傳來的回應。 例如，您可以呼叫命令以在 10 秒內將裝置重新開機。

下表顯示命令功能的組態設定：

| 欄位 | 描述 |
| ----- | ----------- |
| 顯示名稱 | 儀表板和表單上所用命令的顯示名稱。 |
| Name | 命令的名稱。 IoT Central 會從顯示名稱產生此欄位的值，但如有必要，您也可以選擇自己所要使用的值。 此欄位必須是英數位元。 |
| 功能類型 | 命令。 |
| Command | `SynchronousExecutionType`. |
| 註解 | 有關命令功能的任何註解。 |
| 描述 | 命令功能的說明。 |
| 要求 | 若啟用，則為要求參數的定義，包括：名稱、顯示名稱、結構描述、單位和顯示單位。 |
| 回應 | 若啟用，則為命令回應的定義，包括：名稱、顯示名稱、結構描述、單位和顯示單位。 |

## <a name="manage-an-interface"></a>管理介面

如果您尚未發佈介面，則可以編輯介面所定義的功能。 在您發佈介面之後，如果想要進行任何變更，您就必須建立新版本的裝置範本並設定介面版本。 您可以在 [自訂]**** 區段中進行不需要設定版本的變更 (例如，顯示名稱或單位)。

如果您想要在其他功能模型中重複使用介面，也可以將介面匯出為 JSON 檔案。

## <a name="add-cloud-properties"></a>新增雲端屬性

使用雲端屬性可將裝置的相關資訊儲存在 IoT Central 中。 雲端屬性一律不會傳送至裝置。 例如，您可以使用雲端屬性來儲存安裝了裝置的客戶名稱，或儲存裝置的上次維修日期。

下表顯示雲端屬性的組態設定：

| 欄位 | 描述 |
| ----- | ----------- |
| 顯示名稱 | 儀表板和表單上所用雲端屬性值的顯示名稱。 |
| Name | 雲端屬性的名稱。 IoT Central 會從顯示名稱產生此欄位的值，但如有必要，您也可以選擇自己所要使用的值。 |
| 語意類型 | 屬性的語意類型，例如溫度、狀態或事件。 所選擇的語意類型會決定下列哪些欄位可供使用。 |
| 結構描述 | 雲端屬性的資料類型，例如雙精度浮點數、字串或向量。 可用的選項取決於語意類型。 |

## <a name="add-customizations"></a>新增自訂

當您需要修改匯入的介面或將 IoT Central 特有的功能 (feature) 新增至功能 (capability) 時，請使用自訂。 您只能自訂不會中斷介面相容性的欄位。 例如，您可以：

- 自訂功能的顯示名稱和單位。
- 新增在圖表上顯示值時所要使用的預設色彩。
- 指定屬性的初始、最小和最大值。

您無法自訂功能名稱或功能類型。 如果有無法在 [自訂]**** 區段中進行的變更，則必須對裝置範本和介面設定版本才能修改功能 (capability)。

### <a name="generate-default-views"></a>產生預設檢視

產生預設檢視是將重要裝置資訊視覺化的快速方式。 您最多可為裝置範本產生三個預設檢視：

- [命令]**** 會提供具有裝置命令的檢視，並可讓操作員將命令分派至裝置。
- [概觀]**** 為檢視提供裝置遙測，以顯示圖表和計量。
- [關於]**** 為檢視提供裝置資訊，以顯示裝置屬性。

選取 [產生預設檢視]**** 之後，您會看到預設檢視自動新增至裝置範本的 [檢視]**** 區段底下。

## <a name="add-dashboards"></a>新增儀表板

將儀表板新增至裝置範本，可讓操作員使用圖表和計量將裝置視覺化。 一個裝置範本可以有多個儀表板。

若要將儀表板新增至裝置範本：

1. 移至您的裝置範本，然後選取 [ **視圖**]。
1. 選擇 [將裝置視覺化]****。
1. 在 [儀表板名稱]**** 中輸入儀表板的名稱。
1. 從靜態、屬性、雲端屬性、遙測和命令圖格的清單，將圖格新增至儀表板。 將您想要新增的圖格拖放至儀表板。
1. 若要在單一圖表圖格上繪製多個遙測值，請選取遙測值，然後選取 [ **合併**]。
1. 設定您新增的每個圖格，以自訂其顯示資料的方式。 若要這麼做，請選取齒輪圖示，或選取圖表圖格上的 [變更設定]****。
1. 在儀表板上排列圖格和調整其大小。
1. 儲存變更。

### <a name="configure-preview-device-to-view-dashboard"></a>設定預覽裝置以檢視儀表板

若要檢視和測試您的儀表板，請選取 [設定預覽裝置]****。 這可讓您在儀表板發佈之後，看見如操作員所見的儀表板。 使用此選項來驗證檢視所顯示的資料是否正確。 您可選擇下列項目：

- 沒有預覽裝置。
- 您為裝置範本設定的實際測試裝置。
- 應用程式中的現有裝置 (使用裝置識別碼)。

## <a name="add-forms"></a>新增表單

將表單新增至裝置範本，可讓操作員藉由檢視和設定屬性來管理裝置。 操作員只能編輯雲端屬性和可寫入的裝置屬性。 一個裝置範本可以有多個表單。

若要將表單新增至裝置範本：

1. 移至您的裝置範本，然後選取 [ **視圖**]。
1. 選擇 [編輯裝置和雲端資料]****。
1. 在 [表單名稱]**** 中輸入表單的名稱。
1. 選取要用來配置表單的資料行數目。
1. 將屬性新增至表單上的現有區段，或在選取屬性後選擇 [新增區段]****。 使用區段來將表單上的屬性分組。 您可以對區段新增標題。
1. 設定表單上的每個屬性以自訂其行為。
1. 在表單上排列屬性。
1. 儲存變更。

## <a name="publish-a-device-template"></a>發佈裝置範本

您必須先發佈裝置範本，才能連接實作裝置功能模型的裝置。

在發佈裝置範本後，能對裝置功能模型進行的變更就會很有限。 若要修改介面，您必須[建立和發佈新版本](./howto-version-device-template.md)。

若要發佈裝置範本，請移至您的裝置範本，然後選取 [ **發佈**]。

在您發佈裝置範本後，操作員便可移至 [裝置]**** 頁面，並新增會使用裝置範本的實際或模擬裝置。 當您進行變更時，您可以繼續修改並儲存裝置範本。 當您要將這些變更推送給操作員，以在 [裝置]**** 頁面之下檢視時，您每次都必須選取 [發佈]****。

## <a name="next-steps"></a>接下來的步驟

如果您是裝置開發人員，建議的下一個步驟是閱讀 [裝置範本版本](./howto-version-device-template.md)設定的相關資訊。
