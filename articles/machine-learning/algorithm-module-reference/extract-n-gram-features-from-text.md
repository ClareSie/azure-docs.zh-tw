---
title: 從文字模塊參考中解壓縮 N 語法功能
titleSuffix: Azure Machine Learning
description: '瞭解如何使用 Azure Machine Learning 中的「解壓縮 N-#-# #」模組來為文字資料進行特徵化。'
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 09/01/2019
ms.openlocfilehash: efe09c1d516b37c23b024e07ae387772fa7e5992
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/02/2020
ms.locfileid: "79477607"
---
# <a name="extract-n-gram-features-from-text-module-reference"></a>從文字模塊參考中解壓縮 N 語法功能

本文說明 Azure Machine Learning 設計工具 (預覽) 中的模組。 使用 [從文字中解壓縮 N 語法特徵] 模組來為非結構化文字資料提供*特徵*。 

## <a name="configuration-of-the-extract-n-gram-features-from-text-module"></a>設定從文字模塊解壓縮 N 語法功能

此模組支援使用 n 語法字典的下列案例：

* 從任意文字的資料行[建立新的 n 語法字典](#create-a-new-n-gram-dictionary)。

* [使用現有的一組文字功能來設定](#use-an-existing-n-gram-dictionary)自由文字資料行的特徵。

* [分數或發行](#score-or-publish-a-model-that-uses-n-grams)使用 n 元的模型。

### <a name="create-a-new-n-gram-dictionary"></a>建立新的 n 語法字典

1.  將 [從文字中解壓縮 N 中繼資料的功能] 模組新增到您的管線，然後連接包含您想要處理之文字的資料集。

1.  使用 [文字] 資料**行**選擇字串類型的資料行，其中包含您要解壓縮的文字。 因為結果是詳細資訊，所以您一次只能處理一個資料行。

1. 將 [**詞彙模式]** 設定為 [**建立**]，表示您要建立一份 n 語法功能的新清單。 

1. 設定 [ **n-克大小**]，表示要解壓縮和儲存之 N 字母的大小*上限*。 

    例如，如果您輸入3，則會建立 unigrams、bigrams 和 trigrams。

1. **加權**函式會指定如何建立檔功能向量，以及如何從檔中解壓縮詞彙。

    * **二進位權數**：將二進位顯示值指派給已解壓縮的 n 字母。 當檔中存在的每個 n-克時，其值為1，否則為0。

    * **TF 權數**：將「詞彙頻率」（tf）分數指派給已解壓縮的 n 字母。 每個 n-克的值都是在檔中出現的頻率。

    * **IDF 權數**：將反向檔頻率（IDF）分數指派給已解壓縮的 n 字母。 每個 n-克的值是主體大小的記錄，除以其在整個主體中的發生頻率。
    
      `IDF = log of corpus_size / document_frequency`
 
    *  **TF-IDF 權數**：將詞彙頻率/反向檔頻率（TF/IDF）分數指派給已解壓縮的 n 字母。 每個 n-克的值是其 TF 分數乘以其 IDF 分數。

1. 將 [**文字長度下限**] 設定為可在 n-# 語法中的任何*單一單字*中使用的最小字母數目。

1. 使用 [**最大單字長度**] 來設定 n 語法中可用於任何*單一單字*的最大字母數目。

    根據預設，每個單字或 token 允許最多25個字元。

1. 使用**最少 n-克檔的絕對頻率**，以設定要包含在 n 語法字典中的任何 n 元所需的最小發生次數。 

    例如，如果您使用預設值5，則任何 n 語法都必須在主體中至少出現五次，才會包含在 n 語法的字典中。 

1.  在整體主體的資料列數目上，將**n 中繼檔比例上限**設定為包含特定 n-克的資料列數目的最大比例。

    例如，1的比率會指出，即使每個資料列中都有特定的 n 語法，也可以將 n-克加入至 n 語法字典。 更常見的情況是，每個資料列中發生的單字都會被視為非搜尋字，而且會被移除。 若要篩選掉網域相依的非搜尋字，請嘗試減少這項比率。

    > [!IMPORTANT]
    > 特定單字的出現率不是統一的。 這會因檔而異。 例如，如果您要分析關於特定產品的客戶意見，產品名稱可能非常高，且接近非搜尋字，但卻是其他內容中的重要詞彙。

1. 選取 [正規化**n # 語法功能向量**] 選項，以正規化特徵向量。 如果啟用此選項，每個 n 語法特徵向量都會除以其 L2 的標準。

1. 提交管線。

### <a name="use-an-existing-n-gram-dictionary"></a>使用現有的 n 語法字典

1.  將 [從文字中解壓縮 N-元功能] 模組新增至您的管線，然後將含有您要處理之文字的資料集連接到**資料集**埠。

1.  使用 [**文字資料行**] 選取包含您想要特徵化之文字的文字資料行。 根據預設，此模組會選取**字串**類型的所有資料行。 為了獲得最佳結果，請一次處理單一資料行。

1. 新增已儲存的資料集，其中包含先前產生的 n 語法字典，並將其連接到**輸入詞彙**埠。 您也可以在 [文字] 模組中，連接從 [摘錄 N-語法] 功能的上游實例的**結果詞彙**輸出。

1. 針對 [**詞彙模式]**，從下拉式清單中選取 [ **ReadOnly**更新] 選項。

   **ReadOnly**選項代表輸入詞彙的輸入主體。 不是從新的文字資料集計算詞彙頻率（在左側的輸入），而是會套用輸入詞彙中的 n 語法權數。

   > [!TIP]
   > 當您要評分文字分類器時，請使用此選項。

1.  如需所有其他選項，請參閱[上一節](#create-a-new-n-gram-dictionary)中的屬性描述。

1.  提交管線。

### <a name="score-or-publish-a-model-that-uses-n-grams"></a>分數或發行使用 n 元的模型

1.  將 [從文字] 模組的 [將**N 元語法] 功能**從定型資料流程複製到評分資料流程。

1.  將定型資料流程的**結果詞彙**輸出連接到評分資料流程上的**輸入詞彙**。

1.  在評分工作流程中，從 [文字] 模組修改 [解壓縮 N 語法功能]，並將 [**詞彙模式]** 參數設定為 [ **ReadOnly**]。 保留所有其他相同的。

1.  若要發行管線，請將**結果詞彙**儲存為資料集。

1.  將儲存的資料集連接到計分圖形中的 [從文字中解壓縮 N 語法特徵] 模組。

## <a name="results"></a>結果

[從文字中解壓縮 N 語法特徵] 模組會建立兩種類型的輸出： 

* **結果資料集**：此輸出是已分析之文字與已解壓縮之 n 字母結合的摘要。 您未在 [**文字資料行**] 選項中選取的資料行，會傳遞至輸出。 針對您分析的每個文字資料行，此模組會產生下列資料行：

  * **N 語法出現次數的矩陣**：模組會針對 total 主體中找到的每個 n 中繼資料產生一個資料行，並在每個資料行中加入分數，以指出該資料列的 n 中繼資料的權數。 

* **結果詞彙**：詞彙包含實際的 n 語法字典，以及在分析過程中產生的詞彙頻率分數。 您可以使用一組不同的輸入來儲存資料集以重複使用，或用於後續的更新。 您也可以重複使用詞彙來進行模型化和評分。

### <a name="result-vocabulary"></a>結果詞彙

詞彙包含 n-# 語法字典，以及在分析過程中產生的詞彙頻率分數。 不論其他選項為何，都會產生 DF 和 IDF 分數。

+ **ID**：為每個唯一的 n 語法產生的識別碼。
+ **NGram**： n 語法。 空格或其他文字分隔符號會取代成底線字元。
+ **DF**：原始主體中 n-克的詞彙頻率分數。
+ **IDF**：原始主體中 n-克的反向檔頻率分數。

您可以手動更新此資料集，但可能會導致錯誤。 例如：

* 如果模組在輸入詞彙中找到具有相同索引鍵的重復資料列，就會引發錯誤。 請確定詞彙中沒有任何兩個數據列具有相同的單字。
* 詞彙資料集的輸入架構必須完全相符，包括資料行名稱和資料行類型。 
* **識別碼**資料行和**DF**資料行必須是整數類型。 
* **IDF**資料行必須為 float 類型。

> [!Note]
> 不要直接將資料輸出連接到訓練模型模組。 您應該先移除可用的文字資料行，然後再將它們送入訓練模型。 否則，可以將免費的文字資料行視為分類功能。

## <a name="next-steps"></a>後續步驟

請參閱 Azure Machine Learning 的[可用模組集](module-reference.md)。
