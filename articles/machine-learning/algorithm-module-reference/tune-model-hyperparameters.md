---
title: 調整模型超參數
titleSuffix: Azure Machine Learning
description: 瞭解如何在 Azure 機器學習中使用"調模型 Hyper 參數"模組對模型執行參數掃描以確定最佳參數設置。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 02/11/2020
ms.openlocfilehash: ff0ccbf201f2b83dd446859d8054d115a70f402e
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2020
ms.locfileid: "80064168"
---
# <a name="tune-model-hyperparameters"></a>調整模型超參數

本文介紹如何在 Azure 機器學習設計器（預覽）中使用"調模型超參數"模組。 目標是確定機器學習模型的最佳超參數。 該模組使用不同的設置組合生成和測試多個模型。 它比較所有模型的指標，以獲得設置的組合。 

術語*參數*和*超參數*可能會令人困惑。 模型*的參數*是您在模組右側窗格中設置的參數。 基本上，此模組對指定的參數設置執行*參數掃描*。 它學習一組最佳的_超參數_，對於每個特定的決策樹、資料集或回歸方法，這些參數可能不同。 查找最佳配置的過程有時稱為*調優*。 

該模組支援以下方法，用於查找模型的最佳設置：*集成訓練和調諧。* 在此方法中，配置要使用的一組參數。 然後，讓模組反覆運算多個組合。 模組測量精度，直到找到"最佳"模型。 對於大多數學員模組，您可以選擇在培訓過程中應更改哪些參數，哪些參數應保持固定。

根據您希望調優過程運行多長時間，您可以決定徹底測試所有組合。 或者，您可以通過建立參數組合網格和測試參數網格的隨機子集來縮短過程。

此方法生成一個經過訓練的模型，您可以保存以供重用。  

> [!TIP] 
> 您可以執行相關任務。 在開始調整之前，應用要素選擇以確定具有最高資訊值的列或變數。

## <a name="how-to-configure-tune-model-hyperparameters"></a>如何配置調諧模型超參數  

學習機器學習模型的最佳超參數需要大量使用管道。

### <a name="train-a-model-by-using-a-parameter-sweep"></a>使用參數掃描訓練模型  

本節介紹如何執行基本參數掃描，該掃描使用 Tune 模型 Hyper 參數模組訓練模型。

1.  將"調諧模型超參數"模組添加到設計器中的管道中。

2.  將未訓練的模型連接到最左側的輸入。 



4.  添加要用於定型的資料集，並將其連接到 Tune 模型 Hyper 參數的中間輸入。  

    或者，如果您有一個標記的資料集，則可以將其連接到最右側的輸入埠（**可選驗證資料集**）。 這允許您在訓練和調優時測量準確性。

5.  在"調模型超參數"的右側面板中，為**參數掃描模式**選擇值。 此選項控制參數的選擇方式。

    - **整個網格**：當您選擇此選項時，模組會迴圈在系統預定義的網格上，以嘗試不同的組合並識別最佳學員。 當您不知道最佳參數設置可能是什麼並且想要嘗試所有可能的值組合時，此選項非常有用。

    - **隨機掃描**：當您選擇此選項時，模組將在系統定義的範圍內隨機播放參數值。 您必須指定要執行模組的最大運行次數。 如果要使用您選擇的指標提高模型性能，但仍可節省計算資源，則此選項非常有用。    

6.  對於 **"標籤"列**，打開欄選取器以選擇單個標籤列。

7.  選擇運行次數：

    1. **隨機掃描時的最大運行次數**：如果選擇隨機掃描，則可以使用參數值的隨機組合指定應訓練模型的次數。

8.  對於**排名**，選擇一個指標來對模型進行排名。

    運行參數掃描時，模組將計算模型類型的所有適用指標，並在 **"掃描結果**"報表中返回這些指標。 該模組對回歸和分類模型使用單獨的指標。

    但是，您選擇的指標決定了模型的排名方式。 只有按所選指標排列的頂級模型才會輸出為用於評分的經過訓練的模型。

9.  對於**隨機種子**，輸入用於啟動參數掃描的數位。 

10. 提交管道。

## <a name="results-of-hyperparameter-tuning"></a>超參數調優結果

培訓完成後：

+ 要查看最佳模型的一組精度指標，請按右鍵模組，然後選擇 **"視覺化**"。

    輸出包括應用於模型類型的所有精度指標，但為排名選擇的指標決定了哪個模型被視為"最佳"。

+ 要保存已訓練的模型的快照，請在 **"訓練"模型**模組的右側面板中選擇 **"輸出**"選項卡。 選擇 **"註冊"資料集**圖示以將模型保存為可重用模組。


## <a name="technical-notes"></a>技術說明

本節包含實現詳細資訊和提示。

### <a name="how-a-parameter-sweep-works"></a>參數掃描的工作原理

設置參數掃描時，定義搜尋範圍。 搜索可能使用隨機播放的有限數量的參數。 或者，它可能是對您定義的參數空間進行詳盡的搜索。

+ **隨機掃描**：此選項使用一組反覆運算數訓練模型。 

  指定要反覆運算的值範圍，模組使用隨機播放的這些值的子集。 值選擇替換，這意味著以前隨機播放的數位不會從可用數位池中刪除。 因此，選擇任何值的機會在所有刀路中都保持不變。  

+ **整個網格**：使用整個網格的選項意味著每個組合都經過測試。 此選項是最徹底的，但它需要最多的時間。 

### <a name="controlling-the-length-and-complexity-of-training"></a>控制培訓的長度和複雜性

反覆運算多種設置組合可能非常耗時，因此該模組提供了幾種約束過程的方法：

+ 限制用於測試模型的反覆運算次數。
+ 限制參數空間。
+ 限制反覆運算次數和參數空間。

我們建議您使用設置進行管道，以確定對特定資料集和模型進行最有效的培訓方法。

### <a name="choosing-an-evaluation-metric"></a>選擇評估指標

在測試結束時，模型會顯示包含每個模型準確性的報告，以便您可以查看指標結果：

- 所有二進位分類模型都使用一組統一的指標。
- 精度用於所有多類分類模型。
- 回歸模型使用一組不同的指標。 

但是，在培訓期間，您必須選擇一*個*指標來對在調優過程中生成的模型進行排名。 您可能會發現，最佳指標會有所不同，具體取決於您的業務問題以及誤報和假負數的成本。

#### <a name="metrics-used-for-binary-classification"></a>用於二進位分類的指標

-   **準確性**是真實結果與總案例的比例。  

-   **精度**是真實結果與正結果之比。  

-   **召回**是所有結果的所有正確結果的一小部分。  

-   **F-Score**是一種平衡精度和召回的度量。  

-   **AUC**是一個值，表示在 X 軸上繪製誤報時曲線下的區域，並在 y 軸上繪製真正的正數。  

-   **平均日誌損耗**是兩個概率分佈之間的差異：真和模型中的分佈。  

#### <a name="metrics-used-for-regression"></a>用於回歸的指標

-   **平均絕對誤差**平均模型中的所有誤差，其中*誤差*表示預測值與真實值的距離。 它經常被縮寫為*MAE。*  

-   **平均平方誤差的根**測量誤差的平方的平均值，然後獲取該值的根。 它經常被縮寫為*RMSE。*  

-   **相對絕對誤差**表示誤差為真實值的百分比。  

-   **相對平方誤差**通過除以預測值的總平方誤差來使總平方誤差正常化。  

-   **確定係數**是指示資料適合模型的單個數位。 值為 1 表示模型與資料完全符合。 值為零表示資料是隨機的，或者無法適應模型。 它通常被稱為 r * <sup>2、R</sup> * * <sup>2</sup>* 或*r 平方*。  

### <a name="modules-that-dont-support-a-parameter-sweep"></a>不支援參數掃描的模組

Azure 機器學習中的幾乎所有學員都支援使用集成參數掃描進行交叉驗證，從而允許您選擇要管道的參數。 如果學員不支援設置值範圍，您仍可以在交叉驗證中使用。 在這種情況下，為掃描選擇一系列允許的值。 


## <a name="next-steps"></a>後續步驟

請參閱 Azure 機器學習[可用的模組集](module-reference.md)。 

