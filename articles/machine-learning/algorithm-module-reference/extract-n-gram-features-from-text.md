---
title: 從文本模組引用中提取 N-Gram 功能
titleSuffix: Azure Machine Learning
description: 瞭解如何在 Azure 機器學習中使用提取 N-Gram 模組來測量文本資料。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 09/01/2019
ms.openlocfilehash: efe09c1d516b37c23b024e07ae387772fa7e5992
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2020
ms.locfileid: "79477607"
---
# <a name="extract-n-gram-features-from-text-module-reference"></a>從文本模組引用中提取 N-Gram 功能

本文介紹 Azure 機器學習設計器（預覽）中的模組。 使用從文本模組中提取 N-Gram 功能來*測量*非結構化文本資料。 

## <a name="configuration-of-the-extract-n-gram-features-from-text-module"></a>文本模組中提取 N-Gram 功能的配置

該模組支援以下使用 n-gram 字典的方案：

* 從自由文本列創建新的[n-gram 詞典](#create-a-new-n-gram-dictionary)。

* [使用一組現有的文本功能](#use-an-existing-n-gram-dictionary)來對自由文本列進行大量訪問。

* [評分或發佈](#score-or-publish-a-model-that-uses-n-grams)使用 n-gram 的模型。

### <a name="create-a-new-n-gram-dictionary"></a>創建新的 n-gram 詞典

1.  將"從文本"模組中提取 N-Gram 要素添加到管道中，並連接具有要處理的文本的資料集。

1.  使用 **"文本"列**選擇包含要提取的文本的字串類型的列。 由於結果非常詳細，因此一次只能處理一列。

1. 將 **"詞彙"模式**設置為 **"創建**"，以指示要創建新的 n-gram 要素清單。 

1. 設置**N-Gram 大小**以指示要提取和存儲的 n 克*的最大*大小。 

    例如，如果輸入 3，將創建單圖、大圖和三圖。

1. **加權函數**指定如何構建文檔要素向量以及如何從文檔中提取詞彙。

    * **二進位權重**：將二進位存在值分配給提取的 n 克。 當每個 n-gram 存在於文檔中時，每個 n-gram 的值為 1，否則為 0。

    * **TF 重量**： 將術語頻率 （TF） 分數分配給提取的 n 克。 每個 n-gram 的值是文檔中的發生率。

    * **IDF 重量**：將反向文檔頻率 （IDF） 分數分配給提取的 n 克。 每個 n-gram 的值是語料庫大小的日誌除以整個語料庫中的發生頻率。
    
      `IDF = log of corpus_size / document_frequency`
 
    *  **TF-IDF 重量**：將術語頻率/反向文檔頻率 （TF/IDF） 分數分配給提取的 n 克。 每個 n-gram 的值是其 TF 分數乘以其 IDF 分數。

1. 將**最小字長度**設置為可在 n-gram 中的任何*單個單詞*中使用的最小字母數。

1. 使用 **"最大字長**"設置可在 n-gram 中的任何*單個單詞*中使用的最大字母數。

    預設情況下，每個單詞或權杖最多允許 25 個字元。

1. 使用**最小 n-gram 文檔絕對頻率**設置任何 n-gram 包含在 n-gram 字典中所需的最小匹配項。 

    例如，如果使用預設值 5，則任何 n-gram 都必須在要包含在 n-gram 字典中的語料庫中至少出現五次。 

1.  將**最大 n-gram 文檔比率**設置為包含特定 n-gram 的行數的最大比率，而不是整個語料庫中的行數。

    例如，比率為 1 表示，即使每行中都存在特定的 n-gram，也可以將 n-gram 添加到 n-gram 字典中。 更典型的是，每行中發生的單詞將被視為一個雜色詞，並且將被刪除。 要篩選出與域相關的雜色詞，請嘗試降低此比率。

    > [!IMPORTANT]
    > 特定單詞的發生率並不均勻。 它因文檔而異。 例如，如果您正在分析客戶對特定產品的評論，則產品名稱可能非常高，並且接近雜訊詞，但在其他上下文中卻是一個重要術語。

1. 選擇 **"正常化 n-gram 特徵向量"** 選項以正常化要素向量。 如果啟用此選項，則每個 n-gram 特徵向量除以其 L2 規範。

1. 提交管道。

### <a name="use-an-existing-n-gram-dictionary"></a>使用現有的 n-gram 詞典

1.  將"從文本"模組中提取 N-Gram 要素添加到管道，並將具有要處理的文本的資料集連接到**資料集**埠。

1.  使用 **"文本"列**選擇包含要進行的文本文本列。 預設情況下，模組選擇類型**字串**的所有列。 為獲得最佳結果，一次處理單個列。

1. 添加包含以前生成的 n-gram 字典的保存資料集，並將其連接到 **"輸入詞彙"** 埠。 您還可以從文本模組連接提取 N-Gram 功能的上游實例的結果**詞彙**輸出。

1. 對於**詞彙模式**，從下拉清單中選擇 **"唯讀只**更新"選項。

   **"唯讀"** 選項表示輸入詞彙的輸入語號。 輸入詞彙表中的 n-gram 權重應用方式，而不是計算新文本資料集（左輸入）的術語頻率。

   > [!TIP]
   > 在給文本分類器打分時，請使用此選項。

1.  有關所有其他選項，請參閱[上一節中](#create-a-new-n-gram-dictionary)的屬性說明。

1.  提交管道。

### <a name="score-or-publish-a-model-that-uses-n-grams"></a>使用 n-gram 的模型評分或發佈

1.  **從訓練資料流程將提取 N-Gram 功能從文本**模組複製到評分資料流程。

1.  將訓練資料流程**的結果詞彙**輸出連接到評分資料流程上的**輸入詞彙**。

1.  在評分工作流中，從文本模組修改"提取 N-Gram 功能"，並將 **"詞彙"模式**參數設置為 **"唯讀**"。 別的都一樣。

1.  要發佈管道，將**結果詞彙表**另存為資料集。

1.  將保存的資料集連接到評分圖中文本模組的提取 N-Gram 要素。

## <a name="results"></a>結果

從文本模組中提取 N-Gram 功能可創建兩種類型的輸出： 

* **結果資料集**：此輸出是分析文本與提取的 n 克的摘要。 在 **"文本"列**選項中未選擇的列將傳遞到輸出。 對於分析的每個文本列，模組將生成以下列：

  * **n-gram 的矩陣**：模組為總語料庫中找到的每個 n-gram 生成一列，並在每列中添加一個分數，以指示該行的 n-gram 權重。 

* **結果詞彙**：詞彙表包含實際的 n-gram 詞典，以及作為分析的一部分生成的術語頻率分數。 您可以將資料集保存為使用一組不同的輸入重複使用，或用於以後的更新。 您還可以重用用於建模和評分的詞彙表。

### <a name="result-vocabulary"></a>結果詞彙

詞彙表包含 n-gram 字典，其中包含作為分析的一部分生成的術語頻率分數。 無論其他選項如何，都會生成 DF 和 IDF 分數。

+ **ID**：為每個唯一 n-gram 生成的識別碼。
+ **NGram**： n-gram. 空格或其他單詞分隔符號由底線替換。
+ **DF**： 原始語料庫中 n-gram 的術語頻率分數。
+ **IDF**： 原始語料庫中 n-gram 的反向文檔頻率分數。

您可以手動更新此資料集，但可能會引入錯誤。 例如：

* 如果模組在輸入詞彙表中找到具有相同鍵的重複行，則引發錯誤。 確保詞彙表中沒有兩行具有相同的單詞。
* 詞彙資料集的輸入架構必須完全符合，包括列名稱和列類型。 
* **ID**列和**DF**列必須為整數類型。 
* **IDF**列必須為浮動類型。

> [!Note]
> 不要將資料輸出直接連接到列車模型模組。 在將可用文本列輸入到"訓練模型"之前，應刪除這些列。 否則，自由文本列將被視為分類要素。

## <a name="next-steps"></a>後續步驟

請參閱 Azure 機器學習[可用的模組集](module-reference.md)。
