---
title: 交叉驗證模型：模組參考
titleSuffix: Azure Machine Learning
description: 瞭解如何使用 Azure Machine Learning 中的 [交叉驗證模型] 模組，藉由分割資料來交叉驗證分類或回歸模型的參數估計值。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 02/11/2020
ms.openlocfilehash: 63c61b12ad68a3add2e7b40ab0bec38d3c2835e5
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/09/2020
ms.locfileid: "90898575"
---
# <a name="cross-validate-model"></a>交叉驗證模型

本文描述如何使用 Azure Machine Learning 設計工具中的 [交叉驗證模型] 模組。 *交叉驗證* 是一種技術，通常用於機器學習服務，以評估資料集的變化性，以及透過該資料定型之任何模型的可靠性。  

交叉驗證模型模組會以標記的資料集做為輸入，以及未定型的分類或回歸模型。 它會將資料集分成數個 *子集 (折* 迭) 、在每個折迭上建立模型，然後針對每個折迭傳回一組精確度統計資料。 藉由比較所有折迭的精確度統計資料，您可以解讀資料集的品質。 然後，您可以瞭解模型是否容易受到資料的變化。  

交叉驗證模型也會傳回預測的結果和資料集的機率，讓您可以評估預測的可靠性。  

### <a name="how-cross-validation-works"></a>交叉驗證的運作方式

1. 交叉驗證會隨機將定型資料分割成折迭。 

   如果您先前未分割資料集，演算法的預設值為 10 個摺疊。 若要將資料集分割成不同數目的折迭，您可以使用資料 [分割和範例](partition-and-sample.md) 模組，並指出要使用多少折迭。  

2.  模組會將折迭1中的資料設定為用於驗證。  (這有時稱為「 *維持折*迭」。 ) 模組使用其餘的折迭來定型模型。 

    例如，如果您建立了五個折迭，模組會在交叉驗證期間產生五個模型。 此課程模組會使用四個五分之三的資料來訓練每個模型。 它會測試每個模型的剩餘 1-第五個。  

3.  在每個折迭的模型測試期間，模組會評估多個精確度統計資料。 模組所使用的統計資料取決於您正在評估的模型類型。 不同的統計資料可用來評估分類模型與回歸模型。  

4.  當所有折迭的建立和評估程式完成時，[交叉驗證模型] 會針對所有資料產生一組效能度量和計分結果。 請檢查這些計量，以查看是否有任何單一折迭具有高或低精確度。 

### <a name="advantages-of-cross-validation"></a>交叉驗證的優點

評估模型的另一個常見方式是將資料分割成定型集和測試集，方法是使用 [分割資料](split-data.md)，然後驗證定型資料上的模型。 但是交叉驗證可提供一些優點：  

-   交叉驗證會使用更多的測試資料。

    交叉驗證會以較大的資料空間中指定的參數來測量模型的效能。 也就是說，交叉驗證會使用整個訓練資料集來進行定型和評估，而不是使用部分。 相反地，如果您使用隨機分割所產生的資料來驗證模型，通常只會根據可用資料的30% 或更少來評估模型。  

    不過，因為交叉驗證會在較大型的資料集上多次定型和驗證模型，所以需要更大量的計算。 這比在隨機分割上進行驗證需要更長的時間。  

-   交叉驗證會評估資料集和模型。

    交叉驗證並不只是測量模型的精確度。 此外，它也可讓您瞭解資料集的代表性程度，以及模型對資料變化的敏感程度。  

## <a name="how-to-use-cross-validate-model"></a>如何使用交叉驗證模型

如果您的資料集很大，交叉驗證可能需要很長的時間來執行。  因此，您可以在建立和測試模型的初始階段使用交叉驗證模型。 在這個階段中，您可以評估模型參數的健全度， (假設計算時間可容忍) 。 然後，您可以使用已建立的參數搭配 [定型模型](train-model.md) 和 [評估模型](evaluate-model.md) 模組，來定型和評估模型。

在此案例中，您可以使用交叉驗證模型來定型和測試模型。

1. 將交叉驗證模型模組新增至您的管線。 您可以在 Azure Machine Learning 設計師的 [ **模型計分] & 評估** 類別中找到它。 

2. 連接任何分類或回歸模型的輸出。 

    例如，如果您使用 **兩個類別促進式決策樹** 進行分類，請使用您想要的參數來設定模型。 然後，將連接器從分類器的未定型 **模型** 埠拖曳至交叉驗證模型的相符埠。 

    > [!TIP] 
    > 您不必定型模型，因為交叉驗證模型會在評估過程中自動訓練模型。  
3.  在 [交叉驗證模型] 的 **資料集** 埠上，連接任何加上標籤的訓練資料集。  

4.  在 [交叉驗證模型] 的右窗格中，按一下 [ **編輯資料行**]。 選取包含類別標籤的單一資料行或可預測的值。 

5. 如果您想要在相同資料的連續執行之間重複交叉驗證的結果，請設定 **隨機種子** 參數的值。  

6. 提交管線。

7. 如需報表的描述，請參閱 [ [結果](#results) ] 區段。

## <a name="results"></a>結果

所有反復專案都完成之後，交叉驗證模型會為整個資料集建立分數。 它也會建立效能度量，讓您用來評估模型的品質。

### <a name="scored-results"></a>計分的結果

模組的第一個輸出會提供每個資料列的來源資料，以及一些預測的值和相關的機率。 

若要查看結果，請在管線中，以滑鼠右鍵按一下 [交叉驗證模型] 模組。 選取 [將 **計分結果視覺化**]。

| 新增資料行名稱      | 描述                              |
| -------------------- | ---------------------------------------- |
| 評分標籤        | 這個資料行會加入至資料集的結尾。 它包含每個資料列的預測值。 |
| 評分機率 | 這個資料行會加入至資料集的結尾。 指出 **計分標籤**中值的預估機率。 |
| 折迭編號          | 表示在交叉驗證期間，每個資料列都指派給的折迭之以零為起始的索引。 |

 ### <a name="evaluation-results"></a>Evaluation results

第二個報表依折迭分組。 請記住，在執行期間，交叉驗證模型會將定型資料隨機分割成 *n* 折迭 (預設為 10) 。 在資料集的每個反復專案中，交叉驗證模型會使用一個折迭作為驗證資料集。 它會使用其餘的 *n-1* 折迭來定型模型。 每個 *n* 模型都會針對其他所有折迭中的資料進行測試。

在這份報表中，折迭是依索引值以遞增順序列出。  若要在其他任何資料行上排序，您可以將結果儲存為資料集。

若要查看結果，請在管線中，以滑鼠右鍵按一下 [交叉驗證模型] 模組。 選取 [ **依折迭將評估結果視覺化**]。


|資料行名稱| 描述|
|----|----|
|折迭編號| 每個折迭的識別碼。 如果您建立了五個折迭，則會有五個數據子集（編號為0到4）。
|折迭中的範例數目|指派給每個折迭的資料列數目。 它們應該大致相等。 |


根據您要評估的模型類型而定，模組也會包含每個折迭的下列計量： 

+ **分類模型**：精確度、召回率、F 分數、AUC、精確度  

+ **回歸模型**：平均絕對錯誤、根平均平方誤差、相對絕對錯誤、相對平方誤差和決定係數


## <a name="technical-notes"></a>技術說明  

+ 最好先將資料集正規化，然後再使用它們進行交叉驗證。 

+ 交叉驗證模型需要更多運算，而且需要更長的時間才能完成，而不是使用隨機分割的資料集來驗證模型。 原因是交叉驗證模型會定型和驗證模型多次。

+ 當您使用交叉驗證來測量模型的精確度時，不需要將資料集分割成定型集和測試集。 


## <a name="next-steps"></a>後續步驟

請參閱 Azure Machine Learning 的[可用模組集](module-reference.md)。 

