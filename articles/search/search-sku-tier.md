---
title: 選擇定價層或 SKU
titleSuffix: Azure Cognitive Search
description: Azure 認知搜索可以在這些 SKU 中預配:免費、基本和標準,標準在各種資源配置和容量級別中可用。
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 03/30/2020
ms.openlocfilehash: eb11a5cc2deef372ca91c23a8b9c82e17143c85b
ms.sourcegitcommit: eefb0f30426a138366a9d405dacdb61330df65e7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2020
ms.locfileid: "81617715"
---
# <a name="choose-a-pricing-tier-for-azure-cognitive-search"></a>為 Azure 認知搜尋選擇定價層

建立 Azure 認知搜尋服務時,資源是在服務生存期內修復的定價層(或 SKU)[中建立的](search-create-service-portal.md)。 層包括免費、基本、標準和存儲優化。 標準和存儲優化版提供多種配置和容量。

大多數客戶從免費套餐開始,以便評估服務。 評估後,通常在用於開發和生產部署的較高層之一創建第二個服務。

## <a name="feature-availability-by-tier"></a>依層表示的功能可用性

幾乎每個功能都在每個層(包括 Free)上都可用,但資源密集型功能或工作流可能不能正常工作,除非您給予它足夠的容量。 例如,除非數據集很小,[否則 AI 富集](cognitive-search-concept-intro.md)具有長時間運行的技能,這些技能在免費服務上超時。

下表描述了與層相關的功能約束。

| 功能 | 限制 |
|---------|-------------|
| [索引](search-indexer-overview.md) | 索引器在 S3 HD 上不可用。 |
| [客戶管理的加密金鑰](search-security-manage-encryption-keys.md) | 在免費套餐中不可用。 |

## <a name="tiers-skus"></a>層 (SKU)

層按:

+ 您可以建立的索引與索引器的數量
+ 分割區的大小和速度 (實體儲存體)

您選擇的層決定了計費費率。 Azure 門戶的以下螢幕截圖顯示了可用的層,減去定價(您可以在門戶和[定價頁上](https://azure.microsoft.com/pricing/details/search/)找到)。 **免費**、**基本**和**標準**是最常見的層。

**免費**為較小的項目創建有限的搜索服務,包括快速入門和教程。 內部,副本和分區在多個訂閱者之間共用。 您不能擴展免費服務或運行大量工作負載。

**基本**層和**標準**層是最常用的計費層,**預設為"標準**" 。 借助您控制的專用資源,您可以部署更大的專案、優化性能並設置容量。

![Azure 認知搜尋的定價層](media/search-sku-tier/tiers.png "Azure 認知搜尋的定價層")

某些層針對某些類型的工作進行了優化。 例如,**標準 3 高密度 (S3 HD)** 是 S3 的*託管模式*,其中底層硬體針對大量較小的索引進行了優化,並且適用於多租戶方案。 S3 HD 的單位充電與 S3 相同,但硬體針對大量較小索引的快速檔讀取進行了優化。

**存儲優化**層以低於標準層更低的價格提供更大的存儲容量。 主要權衡是更高的查詢延遲,您應該根據特定的應用程式要求對其進行驗證。  要瞭解有關此層的性能注意事項,請參閱[性能和優化注意事項](search-performance-optimization.md)。

您可以在[定價頁上](https://azure.microsoft.com/pricing/details/search/)[、Azure 認知搜索文章中的服務限制](search-limits-quotas-capacity.md)以及預配服務時在門戶頁上瞭解有關各個層的更多內容。

## <a name="billable-events"></a>計費事件

基於 Azure 認知搜尋建構的解決方案可以透過以下方式產生成本:

+ 以最低設定(一個分割區和副本)24x7 執行的服務本身固定成本
+ 向上延伸時增加成本(新增複本或分割區)
+ 頻寬費用 (出站資料傳輸) 
+ 認知搜尋(附加認知服務以進行 AI 充實,或使用 Azure 儲存進行知識存儲)

### <a name="service-costs"></a>服務成本

與虛擬機或其他資源可以"暫停"以避免費用不同,Azure 認知搜索服務始終可用於專用硬體,供獨佔使用。 因此,創建服務是一個計費事件,在創建服務時開始,並在刪除服務時結束。 

最低費用是計費速率的第一個搜索單元(一個副本 x 一個分區)。 此最小值在服務的生存期內是固定的,因為服務不能在此配置以外的任何上運行。 除最小值外,還可以相互獨立添加副本和分區。 以複本和分區增加容量將基於以下公式增加帳單[:(副本 x 分區 x 速率),](#search-units)其中所收取的費率取決於您選擇的定價層。

估算搜索解決方案的成本時,請記住定價和容量不是線性的。 (將容量翻倍超過成本的兩倍。有關公式的工作原理的範例,請參閱[如何分配副本和分區](search-capacity-planning.md#how-to-allocate-replicas-and-partitions)。

### <a name="bandwidth-charges"></a>頻寬費用

使用[Azure 認知搜索索引器](search-indexer-overview.md)可能會影響計費,具體取決於服務的位置。 如果在同一區域中創建 Azure 認知搜索服務,則可以完全消除數據出口費用。 以下是[頻寬定價頁面](https://azure.microsoft.com/pricing/details/bandwidth/)的一些資訊:

+ Microsoft 不向 Azure 上的任何服務或 Azure 認知搜索中的任何出站數據收取任何入站數據的費用。
+ 在多服務解決方案中,當所有服務都位於同一區域時,數據跨線不收取任何費用。

如果服務位於不同的區域,則對出站數據收取費用。 這些費用實際上不是 Azure 認知搜索帳單的一部分。 此處提到它們是因為如果您使用數據或 AI 豐富的索引器從不同區域提取數據,您將看到成本反映在您的總帳單中。

### <a name="ai-enrichment-with-cognitive-services"></a>AI 與認知服務一起豐富

對於[AI 充實](cognitive-search-concept-intro.md),應計劃在 S0 定價層中[附加計費的 Azure 認知服務資源](cognitive-search-attach-cognitive-services.md)(與 Azure 認知搜索位於同一區域,用於即用即付處理)。 附加認知服務沒有固定成本。 您只需為所需的處理付費。

| 作業 | 計費影響 |
|-----------|----------------|
| 文件開裂、文字擷取 | 免費 |
| 文件開裂、影像擷取 | 根據從文檔中提取的圖像數量計費。 在[索引器配置](https://docs.microsoft.com/rest/api/searchservice/create-indexer#indexer-parameters)中 **,imageAction**是觸發圖像提取的參數。 如果**imageAction**設置為「無」(預設值),則不會向您收取影像提取費用。 圖像提取速率記錄在 Azure 認知搜索的[定價詳細資訊](https://azure.microsoft.com/pricing/details/search/)頁上。|
| [內建認知技能](cognitive-search-predefined-skills.md) | 計費費率與直接使用認知服務執行任務的比率相同。 |
| 自訂技能 | 自定義技能是您提供的功能。 使用自定義技能的成本完全取決於自定義代碼是否調用其他按流量計費的服務。 |

[增量擴充(預覽)](cognitive-search-incremental-indexing-conceptual.md)功能允許您提供緩存,使索引器能夠更高效地運行將來修改技能集時所需的認知技能,從而節省時間和金錢。

<a name="search-units"></a>

## <a name="billing-formula-r-x-p--su"></a>計費公式(R x P = SU)

Azure 認知搜索操作需要瞭解的最重要計費概念是*搜索單元*(SU)。 由於 Azure 認知搜索依賴於副本和分區來編制索引和查詢,因此僅按其中一個或另一個計費是沒有意義的。 相反地，會將兩者合併來計費。

SU 是服務使用*的副本*和*分區*的產物 **:(R x P = SU)。**

每個服務都以一個 SU (一個複本乘以一個分割區) 作為最小值。 任何服務的最大值為 36 個 S。 可通過多種方式達到此最大值:例如,6 個分區 x 6 個副本,或 3 個分區 x 12 個副本。 通常使用的總容量小於總容量(例如,3 複製副本、3個分區服務,計費為 9 個 S)。 有關有效組合,請參閱[分區和副本組合](search-capacity-planning.md#chart)圖表。

計費費率為每 SU 每小時一小時。 每個層都有一個遞高的速率。 較高的層具有更大、更快速的分區,這有助於該層的總體小時費率更高。 您可以在[定價詳細信息](https://azure.microsoft.com/pricing/details/search/)頁面上查看每個層的費率。

大多數客戶只能線上提供總容量的一部分，其餘部分則保留。 對於計費,您連線的分區和副本的數量(由 SU 公式計算)決定了您每小時支付的費用。

## <a name="how-to-manage-costs"></a>如何管理成本

以下建議可説明您將成本降至最低:

+ 創建同一區域或盡可能少的區域中的所有資源,以最小化或消除頻寬費用。

+ 將所有服務整合到一個資源組中,如 Azure 認知搜索、認知服務以及解決方案中使用的任何其他 Azure 服務。 在 Azure 門戶中,查找資源組並使用**成本管理**命令深入瞭解實際支出和預計支出。

+ 請考慮前端應用程式的 Azure Web 應用,以便請求和回應保持在資料中心邊界內。

+ 向上擴展以進行資源密集型操作(如索引,然後向下重新調整常規查詢工作負荷)。 從 Azure 認知搜尋的最小配置(一個 SU 由一個分區和一個副本組成)開始,然後監視使用者活動以標識表示需要更多容量的使用模式。 如果存在可預測的模式,則可以將比例與活動同步(您需要編寫代碼來自動執行此模式)。

此外,請造[訪 計費和成本管理](https://docs.microsoft.com/azure/billing/billing-getting-started),訪問與支出相關的內置工具和功能。

無法臨時關閉搜索服務。 專用資源始終可運行,分配給您獨佔使用,供您終身使用。 刪除服務是永久性的,還會刪除其關聯的數據。

就服務本身而言,降低帳單的唯一方法是將副本和分區減少到仍提供可接受的性能和[SLA 合規性](https://azure.microsoft.com/support/legal/sla/search/v1_0/)的級別,或者以較低層創建服務(S1 小時費率低於 S2 或 S3 費率)。 假設您在負載預測的低端預配服務,如果服務增長超過服務,則可以創建第二個較大分層服務,在第二個服務上重建索引,然後刪除第一個服務。

## <a name="how-to-evaluate-capacity-requirements"></a>如何評估容量要求

在 Azure 認知搜尋中,容量建構為*複本*與*分割區*。

+ 副本是搜索服務的實例。 每個副本都承載一個索引的負載平衡副本。 例如,具有六個副本的服務具有服務中載入的每個索引的六個副本。

+ 分區存儲索引並自動拆分可搜索數據。 兩個分區將索引拆分為兩半,三個分區將其拆分為三個分區,等等。 在容量方面,*分區大小*是層之間的主要區分功能。

> [!NOTE]
> 所有標準和儲存優化層都支援[副本和分割區的靈活組合](search-capacity-planning.md#chart),因此您可以通過變更餘額[來優化系統的速度或儲存](search-performance-optimization.md)。 Basic 層最多提供三個副本,但具有一個分區。 免費層不提供專用資源:計算資源由多個訂閱者共用。

### <a name="evaluating-capacity"></a>評估能力

容量和運行服務的成本是齊頭並進的。 層對兩個級別施加了限制:存儲和資源。 您應該同時考慮這兩個限制,因為無論你首先達到的極限是有效限制。

業務需求通常決定了您需要的索引數。 例如,您可能需要一個大型文件儲存庫的全域索引。 或者,您可能需要基於區域、應用程式或業務利基的多個索引。

若要判斷索引的大小，您必須[建置一個](search-create-index-portal.md)索引。 其大小將基於導入的數據和索引配置,例如是否啟用建議器、篩選和排序。 有關設定對大小影響的詳細資訊,請參閱[建立基本索引](search-what-is-an-index.md)。

對於全文搜索,主數據結構是[一個反轉索引](https://en.wikipedia.org/wiki/Inverted_index)結構,其特徵與源數據不同。 對於倒索引,大小和複雜性由內容決定,不一定由饋送到其中的數據量決定。 具有高冗餘的大型數據源可能會導致比包含高可變內容的較小數據集的索引更小。 因此,很少可以根據原始數據集的大小推斷索引大小。

> [!NOTE] 
> 儘管估計索引和存儲的未來需求可能感覺像是猜測,但值得這樣做。 如果層的容量太低,則需要在較高層預配新服務,然後[重新載入索引](search-howto-reindex.md)。 服務沒有從一個 SKU 到另一個 SKU 的就地升級。
>

### <a name="estimate-with-the-free-tier"></a>使用免費套餐進行估算

其中一個預估容量的方法是從免費層開始。 請記住,免費服務最多提供三個索引、50 MB 的存儲空間和2分鐘的索引時間。 使用這些約束估計預計的索引大小可能具有挑戰性,但這些步驟如下:

+ [建立免費服務](search-create-service-portal.md)。
+ 準備一個小型、具有代表性的數據集。
+ [在門戶中生成初始索引](search-create-index-portal.md)並記下其大小。 功能和屬性對存儲有影響。 例如,添加建議器(即按類型搜索查詢)將增加存儲要求。 使用相同的數據集,可以嘗試創建索引的多個版本,每個欄位上具有不同的屬性,以查看存儲要求如何變化。 有關詳細資訊,請參閱[創建基本索引 中的"存儲含義](search-what-is-an-index.md#index-size)"。

手頭粗略估計時,您可能會將兩個索引(開發和生產)的預算金額翻倍,然後相應地選擇您的層。

### <a name="estimate-with-a-billable-tier"></a>使用計費層進行估算

專用資源可以容納更大的採樣和處理時間,以便更切合實際地估計開發過程中的索引數量、大小和查詢量。 一些客戶直接使用計費層,然後在開發專案成熟時重新評估。

1. [查看每個層的服務限制](https://docs.microsoft.com/azure/search/search-limits-quotas-capacity#index-limits),以確定較低層是否可以支援所需的索引數。 在基本層、S1 層和 S2 層中,索引限制分別為 15、50 和 200。 存儲優化層有 10 個索引的限制,因為它旨在支援少量非常大的索引。

1. [在可計費的定價層建立服務](search-create-service-portal.md)：

    + 如果您不確定預計負載,則從"基本"或"S1"低處開始。
    + 如果你知道你將有大規模的索引和查詢負載,請從 S2 甚至 S3 開始。
    + 如果要索引大量數據和查詢負載相對較低,請從 L1 或 L2 的「優化存儲」開始,與內部業務應用程式一樣。

1. [建置初始索引](search-create-index-portal.md)，以判斷來源資料轉譯為索引的情形。 這是唯一能預估索引大小的方式。

1. 在入口網站中[監視儲存體、服務限制、查詢量和延遲](search-monitor-usage.md)。 門戶顯示每秒查詢、限制查詢和搜索延遲。 所有這些值都可以幫助您確定是否選擇了正確的層。 

索引號和大小對分析同樣重要。 這是因為通過充分利用存儲(分區)或對資源(索引、索引器等)的最大限制(以先到者為準)達到最大限制。 入口網站可協助您追蹤這兩項，在 [概觀] 頁面上並排顯示目前的使用量和最大限制。

> [!NOTE]
> 如果文檔包含無關數據,則存儲要求可能會膨脹。 理想情況下,文檔僅包含搜索體驗所需的數據。 二進位資料不可搜尋,應單獨存儲(可能存儲在 Azure 表或 Blob 儲存中)。 然後,應在索引中添加欄位,以保存對外部資料的 URL 引用。 單個文檔的最大大小為 16 MB(如果在一個請求中批量上載多個文檔,則較小)。 有關詳細資訊,請參閱[Azure 認知搜尋 中的服務限制](search-limits-quotas-capacity.md)。
>

**查詢量的考量**

每秒查詢 (QPS) 是性能調優過程中的一個重要指標,但通常只是層考慮,如果您一開始就期望查詢量高。

標準層可以提供副本和分區的平衡。 您可以通過添加用於負載平衡的複本或添加用於並行處理的分區來增加查詢周轉。 然後,您可以在預配服務后調整性能。

如果從一開始就期望高持續查詢卷,則應考慮更高的標準層,由更強大的硬體提供支援。 然後,您可以將分區和副本脫機,甚至切換到較低層服務(如果這些查詢卷未發生)。 有關如何計算查詢輸送量的詳細資訊,請參閱[Azure 認知搜尋性能和優化](search-performance-optimization.md)。

存儲優化層對於大型數據工作負載非常有用,支援在查詢延遲要求不太重要時提供更多整體可用的索引存儲。 您仍應使用其他副本進行負載平衡,併為並行處理其他分區。 然後,您可以在預配服務后調整性能。

**服務等級協定**

免費層和預覽功能不提供[服務級別協定 (SL)。](https://azure.microsoft.com/support/legal/sla/search/v1_0/) 在所有可計費層中，SLA 會在您為您的服務佈建足夠的備援性時生效。 查詢(讀取)SL 需要有兩個或多個複本。 您需要有三個或多個複本用於查詢和索引(讀寫)SL。 分區數不會影響 SL。

## <a name="tips-for-tier-evaluation"></a>定價層評估秘訣

+ 允許指標圍繞查詢構建,並收集有關使用模式的數據(工作時間的查詢,非高峰時間的索引)。 使用此數據通知服務預配決策。 儘管每小時或每天的節奏不可行,但您可以動態調整分區和資源,以適應查詢卷中的計劃更改。 如果水準足夠長,足以保證採取行動,您還可以適應計劃外但持續的更改。

+ 請記住,預配不足的唯一缺點是,如果實際需求大於預測,則可能需要拆解服務。 為了避免服務中斷,您將在更高的層創建新服務,並並行運行該服務,直到所有應用和請求都針對新終結點。

## <a name="next-steps"></a>後續步驟

從免費層開始,並使用數據的子集來瞭解其特徵,從而生成初始索引。 Azure 認知搜索中的數據結構是一個反轉的索引結構。 反轉索引的大小和複雜性由內容決定。 請記住，重複性高的內容所產生的索引，往往會比差異性高的內容所產生的索引小。 因此,內容特徵而不是數據集的大小決定了索引存儲要求。

對索引大小進行初步估計後,請對本文中討論的一個層[預配計費服務](search-create-service-portal.md):基本、標準或存儲優化。 放寬對數據大小調整和重建[索引](search-howto-reindex.md)的任何人為約束,以包括要搜索的所有數據。

視需要[配置資料分割和複本](search-capacity-planning.md)，以取得所需的效能和規模。

如果性能和容量正常,您就完成了。 否則，請在更符合需求的不同定價層重新建立搜尋服務。

> [!NOTE]
> 如果有疑問,請發布到[堆疊溢出](https://stackoverflow.com/questions/tagged/azure-search)或聯絡[Azure 支援](https://azure.microsoft.com/support/options/)。
