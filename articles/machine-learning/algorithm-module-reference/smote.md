---
title: SMOTE
titleSuffix: Azure Machine Learning
description: 瞭解如何在 Azure Machine Learning 中使用 SMOTE 模組，以使用超取樣來增加資料集中的低發生範例數目。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/16/2019
ms.openlocfilehash: 501f3e8946023d28d67a33fbbfca661afbc6306d
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/22/2020
ms.locfileid: "90898276"
---
# <a name="smote"></a>SMOTE

本文說明如何使用 Azure Machine Learning 設計工具中的 SMOTE 模組，來增加用於機器學習之資料集中的不具代表性案例數目。 SMOTE 是較好的方式，可增加比只複製現有案例更罕見的案例數目。  

您會將 SMOTE 模組連接到 *不平衡*的資料集。 有許多原因可能會不平衡資料集。 例如，您要設為目標的類別在擴展中可能很罕見，或資料可能很難收集。 一般來說，當您想要分析的 *類別* 是不具代表性時，您會使用 SMOTE。 
  
模組會傳回包含原始範例的資料集。 它也會根據您指定的百分比，傳回多個綜合少數樣本。  
  
## <a name="more-about-smote"></a>深入瞭解 SMOTE

綜合少數超取樣技術 (SMOTE) 是一種統計技術，可讓您以平衡的方式增加資料集中的案例數目。 此模組的運作方式是從您提供做為輸入的現有少數案例產生新的實例。 這項 SMOTE 的執行 *不會變更大部分* 案例的數目。

新的實例並不只是現有少數案例的複本。 相反地，演算法會針對每個目標類別和其最接近的鄰近專案，取得 *功能空間* 的範例。 然後，演算法會產生新的範例，將目標案例的功能與其鄰近專案的功能結合在一起。 此方法能增加每個類別可用的特徵，並讓樣本更加一般化。
  
SMOTE 會將整個資料集做為輸入，但只會增加少數案例的百分比。 例如，假設您有一個不平衡資料集，其中1% 的案例的目標值為 (少數類別) ，而99% 的案例具有值 B。若要將少數案例的百分比增加到前一個百分比，您可以在模組的屬性中輸入 **200** 的 **SMOTE 百分比** 。  
  
## <a name="examples"></a>範例  

我們建議您嘗試將 SMOTE 用於小型的資料集，藉此了解它的作用為何。 下列範例會使用 Azure Machine Learning 表設計工具中可用的血捐贈資料集。
  
如果您將資料集加入至管線，並在資料集的輸出上選取 [ **視覺化** ]，就可以看到資料集的748資料列或案例中，570案例 (76%) 屬於類別0，而178案例 (24%) 屬於類別1。 雖然此結果並不是不平衡，但類別1代表捐贈血的人，因此這些資料列包含您想要建立模型的 *功能空間* 。
 
若要增加案例數目，您可以使用100的倍數來設定 **SMOTE 百分比**的值，如下所示：

||類別 0|類別1|total|  
|-|-------------|-------------|-----------|  
|原始資料集<br /><br />  (相當於**SMOTE 百分比**  =  **0**) |570<br /><br /> 76%|178<br /><br /> 24|748|  
|**SMOTE 百分比**  = **100**|570<br /><br /> 62%|356<br /><br /> 38%|926|  
|**SMOTE 百分比**  = **200**|570<br /><br /> 52%|534<br /><br /> 48%|1,104|  
|**SMOTE 百分比**  = **300**|570<br /><br /> 44%|712<br /><br /> 56%|1282|  
  
> [!WARNING]
> 不保證使用 SMOTE 來增加案例數目，因此不會產生更精確的模型。 嘗試以不同的百分比、不同的功能集和不同數目的最近鄰近專案進行管線處理，以瞭解新增案例如何影響您的模型。  
  
## <a name="how-to-configure-smote"></a>如何設定 SMOTE
  
1.  將 SMOTE 模組新增至您的管線。 您可以在 [**操作**] 分類中的 [**資料轉換模組**] 下找到此模組。

2. 連接您想要提升的資料集。 如果您想要指定用來建立新案例的功能空間（只要使用特定資料行或排除某些資料行），請使用 [ [選取資料集中的資料行](select-columns-in-dataset.md) ] 模組。 然後，您可以在使用 SMOTE 之前，先隔離您要使用的資料行。
  
    否則，透過 SMOTE 建立新的案例是根據您提供做為輸入的 *所有* 資料行。 特徵資料行中至少有一個資料行是數值。
  
3.  確定已選取包含標籤或目標類別的資料行。 SMOTE 只接受二進位標籤。
  
4.  SMOTE 模組會自動識別標籤資料行中的少數類別，然後取得少數類別的所有範例。 所有資料行都不能有 NaN 值。
  
5.  在 [ **SMOTE 百分比** ] 選項中，輸入一個整數，指出輸出資料集中少數案例的目標百分比。 例如：  
  
    - 輸入 **0**。 SMOTE 模組會傳回您提供做為輸入的完全相同資料集。 它不會加入任何新的少數案例。 在此資料集中，類別比例沒有變更。  
  
    - 輸入 **100**。 SMOTE 模組會產生新的少數案例。 它會加入原始資料集中相同數量的少數案例。 由於 SMOTE 不會增加大部分的案例數目，因此每個類別的案例比例已變更。  
  
    - 輸入 **200**。 相較于原始資料集，模組會將少數案例的百分比加倍。 這樣 *做並不會* 產生與之前一樣多的少數案例。 相反地，資料集的大小會隨著大部分案例數目保持不變的方式增加。 少數案例的數目會增加，直到符合所需的百分比值為止。  
  
    > [!NOTE]
    > 使用100的倍數作為 SMOTE 百分比。

6.  使用 **最近的鄰近專案數目** 選項，來決定 SMOTE 演算法在建立新案例時所使用的功能空間大小。 最接近的相鄰節點是一個資料列， (類似于目標案例的案例) 。 任兩個案例之間的距離是藉由結合所有功能的加權向量來測量。  
  
    + 藉由增加最接近鄰近專案的數目，您可以從更多案例取得功能。
    + 藉由維持最接近鄰近專案的數目，您可以使用與原始範例中的功能更相似的功能。  
  
7. 如果您想要使用相同的資料，來確保相同的管線執行相同的結果，請在 [ **隨機種子** ] 方塊中輸入值。 否則，模組會在部署管線時，根據處理器時鐘值產生隨機種子。 隨機種子的產生可能會在執行時產生稍微不同的結果。

8. 提交管線。  
  
   模組的輸出是包含原始資料列的資料集，加上一些具有少數案例的加入資料列。  

## <a name="technical-notes"></a>技術說明

+ 當您發行的模型使用 **SMOTE** 模組時，請先從預測性管線移除 **SMOTE** ，然後再將它發佈為 web 服務。 原因是，SMOTE 的目的是要在定型期間改善模型，而不是用於計分。 如果已發佈的預測管線包含 SMOTE 模組，您可能會收到錯誤。

+ 如果您在套用 SMOTE 之前清除遺漏值或套用其他轉換來修正資料，通常可以得到更好的結果。 

+ 有些研究人員已調查過 SMOTE 是否適用于高維度或稀疏資料，例如文字分類或 genomics 資料集中所使用的資料。 這份檔提供在這類情況下套用 SMOTE 之效果和理論有效性的良好摘要： [Blagus 和 Lusa： SMOTE （適用于高維度的類別不平衡資料](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-106)）。

+ 如果 SMOTE 在您的資料集中沒有任何作用，您可能會考慮的其他方法包括：
  + 超取樣少數案例或 undersampling 大部分案例的方法。
  + 集團的技術可協助您使用群集、封袋] 或彈性提升來直接學習模組。


## <a name="next-steps"></a>後續步驟

請參閱 Azure Machine Learning 的[可用模組集](module-reference.md)。 

