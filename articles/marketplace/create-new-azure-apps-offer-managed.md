---
title: 設定受控應用程式方案
description: 瞭解如何在合作夥伴中心中為您的 Azure 應用程式供應專案設定受控應用程式方案。
author: aarathin
ms.author: aarathin
ms.reviewer: dannyevers
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: how-to
ms.date: 11/06/2020
ms.openlocfilehash: 66da9124a6b46fa34d0a13c8992cd3141b095422
ms.sourcegitcommit: 22da82c32accf97a82919bf50b9901668dc55c97
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/08/2020
ms.locfileid: "94370024"
---
# <a name="configure-a-managed-application-plan"></a>設定受控應用程式方案

本文僅適用于 Azure 應用程式供應專案的受控應用程式方案。 如果您要設定解決方案範本方案，請移至 [ [設定方案範本方案](create-new-azure-apps-offer-solution.md)]。

## <a name="define-markets-pricing-and-availability"></a>定義市場、定價和可用性

每個方案必須至少於一個市場供應。 在 [ **定價和可用性** ] 索引標籤上，您可以設定市場將提供此方案的價格、價格，以及是否讓每個人都能看見方案，或是僅對特定客戶顯示方案)  (也稱為私用方案。

1. 在 [ **市場** ] 下，選取 [ **編輯市場** ] 連結。
1. 在出現的對話方塊中，選取您要讓方案可供使用的市場位置。 您必須選取最少1個或最多141市場。

    > [!NOTE]
    > 此對話方塊包含搜尋方塊，以及僅篩選「稅金已匯款」國家/地區的選項，Microsoft 免除銷售並代表您使用稅額。

1. 選取 [ **儲存** ] 以關閉對話方塊。

## <a name="define-pricing"></a>定義定價

在 [ **價格** ] 方塊中，提供此方案的每月價格。 這是此解決方案所部署之資源所產生的任何 Azure 基礎結構或以使用量為基礎的成本以外的價格。

除了每月價格之外，您也可以使用[計量付費計費](partner-center-portal/azure-app-metered-billing.md)，設定非標準單位耗用量的價格。 如有需要，您可以將每月價格設定為零，並只使用計量付費計費。

價格的設定單位為美元 (USD = 美國貨幣) 會在儲存時使用目前的匯率轉換成所有選定市場的當地貨幣。 在發佈之前，請先匯出價格試算表，並檢閱每個市場的價格，以驗證這些價格。 如果想要在個別市場設定自訂價格，請修改並匯入價格試算表。

### <a name="add-a-custom-meter-dimension-optional"></a>將自訂計量維度新增 (選擇性) 

1. 在 [ **Marketplace 計量服務維度** ] 下，選取 [ **新增自訂計量維度 (最大 18)** ] 連結。
1. 在 [ **識別碼** ] 方塊中，輸入在發出使用事件時不可變的識別碼參考。
1. 在 [ **顯示名稱** ] 方塊中，輸入與維度相關聯的顯示名稱。 例如，「傳送的文字訊息」。
1. 在 [ **測量單位** ] 方塊中，輸入計費單位的描述。 例如，「每一文字訊息」或「每100電子郵件」。
1. 在 [ **每單位價格（以美元為單位** ）] 方塊中，輸入維度一個單位的價格。
1. 在 [基礎] 方塊中的 [ **每月數量** ] 中，輸入每月包含每月費用的整數) 的數量 (作為每月的每月費用。 若要設定無限數量，請改為選取核取方塊。
1. 若要加入另一個自訂計量維度，請重複步驟1到7。

### <a name="set-custom-prices-optional"></a>將自訂價格設定 (選用) 

以美元設定的價格會在儲存時使用目前的匯率，轉換為所有選定市場的本地貨幣。 在發佈之前，請先匯出價格試算表，並檢閱每個市場的價格，以驗證這些價格。 如果想要在個別市場設定自訂價格，請修改並匯入價格試算表。

發佈之前，請先仔細檢閱您的價格，因為在方案發佈後可能會變更的部分有一些限制。

> [!NOTE]
> 在您的方案中發佈市場價格之後，之後就無法進行變更。

若要在個別市場中設定自訂價格，請匯出、修改，然後匯入定價試算表。 您必須負責驗證此定價並擁有這些設定。 如需詳細資訊，請參閱 [自訂價格](plans-pricing.md#custom-prices)。

1. 您必須先儲存您的價格變更，才能匯出價格資料。 在 [ **定價和可用性** ] 索引標籤的底部附近，選取 [ **儲存草稿** ]。
1. 在 [ **價格** ] 下，選取 [ **匯出定價資料** ] 連結。
1. 在 Microsoft Excel 中開啟 exportedPrice.xlsx 檔案。
1. 在試算表中，將您想要的更新用於您的定價資訊，然後儲存檔案。

   您可能需要在 Excel 中啟用編輯，才能更新檔案。

1. 在 [ **定價和可用性** ] 索引標籤的 [ **定價** ] 底下，選取 [匯 **入定價資料** ] 連結。
1. 在出現的對話方塊中，按一下 [ **是** ]。
1. 選取您更新的 exportedPrice.xlsx 檔案，然後按一下 [ **開啟** ]。

## <a name="choose-who-can-see-your-plan"></a>選擇可查看您方案的人員

您可以將每個方案設定為每個人都可以看見，或僅供特定的物件使用。 您可以使用 Azure 訂用帳戶識別碼來授與私人物件的存取權，並提供您指派的每個訂用帳戶識別碼的描述。 您可以使用手動新增最多10個訂用帳戶識別碼或最多10000個訂用帳戶識別碼。CSV 檔案。 Azure 訂用帳戶識別碼會以 GUID 表示，而且字母必須是小寫。

> [!NOTE]
> 如果您發行私人方案，您可以在稍後將其可見度變更為 public。 不過，一旦您發行公用方案之後，就無法將其可見度變更為私用。

在 [ **計畫可見度** ] 下，執行下列其中一項：

- 若要將方案設為公用，請選取 [ **公用** ] 選項按鈕 (也稱為 _選項按鈕_ ) 。
- 若要將方案設為私用，請選取 [ **私** 用] 選項按鈕，然後手動或使用 CSV 檔案來新增 Azure 訂用帳戶識別碼。

> [!NOTE]
> 私人對象或有限對象不同於您在 [預覽] 索引標籤上定義的預覽對象。預覽對象可以在供應項目即時發佈到 Marketplace 上之前先存取。 雖然私人對象選擇僅適用於特定方案，但預覽對象可以基於驗證目的，檢視所有方案 (無論是否為私人方案)。

### <a name="manually-add-azure-subscription-ids-for-a-private-plan"></a>手動新增私人方案的 Azure 訂用帳戶識別碼

1. 在 [ **計畫可見度** ] 下，選取 [ **私** 用] 選項按鈕。
1. 在出現的 [ **Azure 訂** 用帳戶識別碼] 方塊中，輸入您想要授與此私人方案存取權之物件的 azure 訂用帳戶識別碼。 至少需要一個訂用帳戶識別碼。
1.  (選擇性) 在 [ **描述** ] 方塊中輸入此物件的描述。
1. 若要新增另一個訂用帳戶識別碼，請選取 [ **新增識別碼 (最大 10)** ] 連結，然後重複步驟2和3。

### <a name="use-a-csv-file-to-add-azure-subscription-ids-for-a-private-plan"></a>使用。用來新增私人方案之 Azure 訂用帳戶識別碼的 CSV 檔案

1. 在 [ **計畫可見度** ] 下，選取 [ **私** 用] 選項按鈕。
1. 選取 [ **匯出物件 (csv])** 連結。
1. 開啟。CSV 檔案，並將您想要授與私人供應專案存取權的 Azure 訂用帳戶識別碼新增至 [ **識別碼** ] 資料行。
1. （選擇性）在 [ **描述** ] 欄中輸入每個物件的描述。
1. 針對具有訂用帳戶識別碼的每個資料列，在 [ **類型** ] 資料行中新增「SubscriptionId」。
1. 儲存。CSV 檔案。
1. 在 [ **可用性** ] 索引標籤的 [ **計畫可見度** ] 下，選取 [匯 **入物件 (csv])** 連結。
1. 在出現的對話方塊中，選取 [ **是** ]。
1. 選取。CSV 檔案，然後選取 [ **開啟** ]。 隨即出現一則訊息，指出。已成功匯入 CSV 檔案。

## <a name="define-the-technical-configuration"></a>定義技術設定

在 [ **技術** 設定] 索引標籤上，您將上傳部署套件，讓客戶部署您的方案並提供套件的版本號碼。 您也會提供其他技術資訊。

> [!NOTE]
> 如果您在 [ **方案設定** ] 索引標籤上選擇重複使用另一個方案的封裝，則不會顯示此索引標籤。如果是，請移至 [您的方案](#view-your-plans)。

### <a name="assign-a-version-number-for-the-package"></a>指派套件的版本號碼

在 [ **版本** ] 方塊中，提供技術設定的目前版本。 在每次發佈此頁面的變更時，遞增此版本。 版本號碼必須採用下列格式：整數整數。 例如 `1.0.2`。

### <a name="upload-a-package-file"></a>上傳套件檔案

在 [ **封裝檔 ( .zip)** 下，將您的封裝檔案拖曳至灰色方塊，或選取 [ **流覽您的檔案 () ]** 連結。

> [!NOTE]
> 如果上傳檔案時發生問題，請確定您的區域網路不會封鎖合作夥伴中心所使用的 `https://upload.xboxlive.com` 服務。

#### <a name="previously-published-packages"></a>先前發佈的套件

[先前發佈的套件] 子索引標籤可讓您檢視所有已發佈的技術設定版本。

### <a name="enable-just-in-time-jit-access-optional"></a>啟用即時 (JIT) 存取 (選擇性) 

若要啟用此計畫的 JIT 存取，請選取 [ **啟用即時 (JIT) 存取** ] 核取方塊。 若要要求受控應用程式的取用者授與您的帳戶永久存取權，請將此選項保留為未核取狀態。 若要深入瞭解這個選項，請參閱及時 [ (JIT) 存取](plan-azure-app-managed-app.md#just-in-time-jit-access)。

### <a name="select-a-deployment-mode"></a>選取部署模式

選取 [ **完整** **] 或 [** 累加部署] 模式。

- 在 **完整** 模式中，客戶重新部署應用程式將會導致移除受控資源群組中的資源（如果 [mainTemplate.js](/azure/azure-resource-manager/managed-applications/publish-service-catalog-app?tabs=azure-powershell#create-the-arm-template.md)中未定義資源）。
- 在 **累加模式中** ，應用程式的重新部署會讓現有的資源保持不變。

若要深入了解部署模式，請參閱 [Azure Resource Manager 部署模式](/azure/azure-resource-manager/deployment-modes.md) \(部分機器翻譯\)。

### <a name="provide-a-notification-endpoint-url"></a>提供通知端點 URL

在 [ **通知端點 URL** ] 方塊中，提供 HTTPS Webhook 端點，以接收有關此方案版本之 managed 應用程式實例上所有 CRUD 作業的通知。

### <a name="customize-allowed-customer-actions-optional"></a>自訂允許的客戶動作 (選擇性) 

1. 若要指定客戶可以在受管理資源上執行的動作，以及「 `*/read` 預設可用的動作」以外的動作，請選取 [ **自訂允許的客戶動作** ] 方塊。
1. 在出現的方塊中，提供您想要讓客戶執行的其他控制項動作和允許的資料動作（以分號分隔）。 例如，若要允許取用者重新開機虛擬機器，請新增 `Microsoft.Compute/virtualMachines/restart/action` 至 [ **允許的控制動作** ] 方塊。

### <a name="choose-who-can-manage-the-application"></a>選擇可以管理應用程式的人員

指出誰應該在每個選取的 Azure 區域中擁有此受控應用程式的管理存取權： _全域 Azure_ 和 _Azure Government 雲端_ 。 您將使用 Azure AD 身分識別來識別您想要授與許可權給受控資源群組的使用者、群組或應用程式。 如需詳細資訊，請參閱 [為 Azure 應用程式供應專案規劃 Azure 受控應用程式](plan-azure-application-offer.md)。

針對全域 Azure 和 Azure Government 雲端完成下列步驟（適用）。

1. 在 [ **Azure Active Directory 租使用者識別碼** ] 方塊中，輸入 Azure AD 租使用者識別碼 (也稱為目錄識別碼) ，其中包含您要授與許可權的使用者、群組或應用程式的身分識別。
1. 在 [ **主體識別碼** ] 方塊中，提供您想要授與受管理資源群組之許可權的使用者、群組或應用程式的 AZURE AD 物件識別碼。 依據使用者的主體識別碼來識別使用者，您可以在 Azure 入口網站的 [Azure Active Directory 使用者](https://portal.azure.com/#blade/Microsoft_AAD_IAM/UsersManagementMenuBlade/AllUsers) ] 分頁中找到此識別碼。
1. 從 [ **角色定義** ] 清單中，選取 Azure AD 內建角色。 您選取的角色描述主體將對客戶訂用帳戶中的資源擁有的許可權。
1. 若要新增其他授權，請選取 [ **新增授權 (最大 100)** ] 連結，然後重複步驟1到3。

### <a name="policy-settings-optional"></a>原則設定 (選擇性) 

您最多可以設定五個原則，而且每個 [原則] 選項只能有一個執行個體。 有些原則需要額外的參數。

1. 在 [ **原則設定** ] 下，選取 [ **+ 新增原則 (最多 5)** ] 連結。
1. 在 [ **名稱** ] 方塊中，輸入原則指派名稱 (限制為50個字元) 。
1. 從 [ **原則** ] 清單方塊中，選取將套用至客戶訂用帳戶中受控應用程式所建立之資源的 Azure 原則。
1. 在 [ **原則參數** ] 方塊中，提供應該套用審核及診斷設定原則的參數。
1. 從 [ **原則 sku** ] 清單方塊中，選取原則 sku 類型。

    > [!NOTE]
    > 稽核原則需要 _標準原則_ SKU。

## <a name="view-your-plans"></a>查看您的方案

- 選取 [ **儲存草稿** ]，然後在頁面的左上方，選取 [ **計畫總覽** ] 返回 [ **計畫總覽** ] 頁面。

當您建立一或多個方案之後，您會在 [ **方案總覽** ] 索引標籤上看到您的方案名稱、方案識別碼、方案類型、可用性 (公用或私用) 、目前的發佈狀態，以及任何可用的動作。

[ **計畫總覽** ] 索引標籤之 [ **動作** ] 欄中的可用動作，會根據您的方案狀態而有所不同，而且可能包含下列各項：

- 如果方案狀態為 **Draft** ，則 [ **動作** ] 欄中的連結將會顯示 [ **刪除草稿** ]。
- 如果方案狀態為 [ **即時** ]，[ **動作** ] 資料行中的連結將會 **停止銷售計畫** 或 **同步私用物件** 。 [ **同步私用物件** ] 連結只會發佈您私用物件的變更，而不會發行您可能對該供應專案所做的任何其他更新。
- 若要為此供應專案建立另一個方案，請在 [ **方案總覽** ] 索引標籤的頂端，選取 [ **+ 建立新方案** ]。 然後重複 [有關如何為您的 Azure 應用程式供應專案建立方案](create-new-azure-apps-offer-plans.md)的步驟。 否則，如果您已完成建立方案，請移至下一節：接下來的步驟。

## <a name="next-steps"></a>後續步驟

- [如何測試及發佈您的 Azure 應用程式供應](create-new-azure-apps-offer-test-publish.md)專案。
- 瞭解如何透過與 Microsoft 共同銷售並轉售給 Csp 方案， [來行銷您的 Azure 應用程式供應](create-new-azure-apps-offer-marketing.md) 專案。
