---
title: 計算和儲存選項-適用於 PostgreSQL 的 Azure 資料庫彈性的伺服器
description: 本文說明適用於 PostgreSQL 的 Azure 資料庫彈性伺服器中的計算和儲存體選項。
author: lfittl-msft
ms.author: lufittl
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2020
ms.openlocfilehash: ca60c44d1e167367e2c138af1e7bfd4ba1a69417
ms.sourcegitcommit: 19dce034650c654b656f44aab44de0c7a8bd7efe
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/04/2020
ms.locfileid: "91710068"
---
# <a name="compute-and-storage-options-in-azure-database-for-postgresql---flexible-server"></a>適用於 PostgreSQL 的 Azure 資料庫-彈性伺服器中的計算和儲存體選項

> [!IMPORTANT]
> 適用於 PostgreSQL 的 Azure 資料庫 - 彈性伺服器為預覽狀態

您可以使用下列三種不同的定價層之一來建立適用於 PostgreSQL 的 Azure 資料庫伺服器：高載、一般用途和記憶體優化。 定價層的差別在於虛擬核心中可佈建的計算數量、每個虛擬核心的記憶體，以及用來儲存資料的儲存體技術。 所有資源都會佈建在 PostgreSQL 伺服器層級。 一個伺服器可以有一個或多個資料庫。

| 資源/層 | **高載** | **一般用途** | **記憶體優化** |
|:---|:----------|:--------------------|:---------------------|
| 虛擬核心 | 1, 2 | 2、4、8、16、32、48、64 | 2、4、8、16、32、48、64 |
| 每個虛擬核心的記憶體 | 變數 | 4 GB | 6.75 到 8 GB |
| 儲存體大小 | 32 GB 至 16 TB | 32 GB 至 16 TB | 32 GB 至 16 TB |
| 資料庫備份的保留期限 | 7 至 35 天 | 7 至 35 天 | 7 至 35 天 |

若要選擇定價層，請從下表著手。

| 定價層 | 目標工作負載 |
|:-------------|:-----------------|
| 高載 | 最適合不需要持續完整 CPU 的工作負載。 |
| 一般用途 | 需要平衡的計算和記憶體以及可擴充 I/O 輸送量的大多數商務工作負載。 範例包括用於裝載 Web 和行動應用程式的伺服器，以及其他企業應用程式。|
| 記憶體最佳化 | 需要記憶體內效能來提供更快速交易處理和更高並行性的高效能資料庫工作負載。 範例包括用於處理即時資料的伺服器，以及高效能交易式或分析應用程式。|

建立伺服器之後，計算層、虛擬核心數目和儲存體大小可以在數秒內上下變更。 您也可以單獨調整備份保留期限。 如需詳細資訊，請參閱 [調整資源](#scale-resources) 一節。

## <a name="compute-tiers-vcores-and-server-types"></a>計算層、虛擬核心和伺服器類型

您可以根據層、虛擬核心和記憶體大小來選取計算資源。 虛擬核心代表基礎硬體的邏輯 CPU。

可用伺服器類型的詳細規格如下所示：

| SKU 名稱             | 虛擬核心 | 記憶體大小 | 支援的 IOPS 上限 | 最大支援 i/o 頻寬 |
|----------------------|--------|-------------|--------------------|-----------------------------|
| **高載**        |        |             |                    |                             |
| B1ms                 | 1      | 2 GiB       | 640                | 15 MiB/秒                  |
| B2s                  | 2      | 4 GiB       | 1280               | 15 MiB/秒                  |
| **一般用途**  |        |             |                    |                             |
| D2s_v3               | 2      | 8 GiB       | 3200               | 48 MiB/秒                  |
| D4s_v3               | 4      | 16 GiB      | 6400               | 96 MiB/秒                  |
| D8s_v3               | 8      | 32 GiB      | 12800              | 192 MiB/秒                 |
| D16s_v3              | 16     | 64 GiB      | 18000              | 384 MiB/秒                 |
| D32s_v3              | 32     | 128 GiB     | 18000              | 750 MiB/秒                 |
| D48s_v3              | 48     | 192 GiB     | 18000              | 750 MiB/秒                 |
| D64s_v3              | 64     | 256 GiB     | 18000              | 750 MiB/秒                 |
| **記憶體優化** |        |             |                    |                             |
| E2s_v3               | 2      | 16 GiB      | 3200               | 48 MiB/秒                  |
| E4s_v3               | 4      | 32 GiB      | 6400               | 96 MiB/秒                  |
| E8s_v3               | 8      | 64 GiB      | 12800              | 192 MiB/秒                 |
| E16s_v3              | 16     | 128 GiB     | 18000              | 384 MiB/秒                 |
| E32s_v3              | 32     | 256 GiB     | 18000              | 750 MiB/秒                 |
| E48s_v3              | 48     | 384 GiB     | 18000              | 750 MiB/秒                 |
| E64s_v3              | 64     | 432 GiB     | 18000              | 750 MiB/秒                 |

## <a name="storage"></a>儲存體

您佈建的儲存體是「適用於 PostgreSQL 伺服器的 Azure 資料庫」可用的儲存體容量。 儲存體會用於資料庫檔案、暫存檔案、交易記錄和 PostgreSQL 伺服器記錄。 您佈建的儲存體總數也會定義您伺服器可用的 I/O 容量。

儲存體提供下列固定大小：

| 磁碟大小 | IOPS |
|:---|:---|
| 32 GiB | 布建的120，最高3500 |
| 64 GiB | 布建的240，最高3500 |
| 128 GiB | 布建的500，最高3500 |
| 256 GiB | 布建的1100，最高3500 |
| 512 GiB | 布建的2300，最高3500 |
| 1 TiB | 5,000 |
| 2 TiB | 7,500 |
| 4 TiB | 7,500 |
| 8 TiB | 16,000 |
| 16 TiB | 18,000 |

請注意，IOPS 也會受限於您的 VM 類型。 雖然您可以選取任何與伺服器類型無關的儲存體大小，但是您可能無法使用存放裝置提供的所有 IOPS，特別是當您選擇的伺服器具有少量的虛擬核心時。

您可以在建立伺服器期間或之後，新增額外的儲存體容量。

>[!NOTE]
> 儲存體只能相應增加，無法相應減少。

您可以在 Azure 入口網站或使用 Azure CLI 命令來監視 I/O 耗用量。 要監視的相關計量包括 [儲存體限制、儲存體百分比、使用的儲存體和 IO 百分比](concepts-monitoring.md)。

### <a name="maximum-iops-for-your-configuration"></a>您設定的最大 IOPS

|SKU 名稱            |GiB 中的儲存體大小                       |32 |64 |128 |256 |512  |1,024|2,048|4,096|8,192 |16,384|
|--------------------|------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |IOPS 上限                              |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**高載**       |                                          |   |   |    |    |     |     |     |     |      |      |
|B1ms                |640 IOPS                                  |120|240|500 |640 *|640 * |640 * |640 * |640 * |640 *  |640 *  |
|B2s                 |1280 IOPS                                 |120|240|500 |1100|1280 *|1280 *|1280 *|1280 *|1280 * |1280 * |
|**一般用途** |                                          |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |3200 IOPS                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|D4s_v3              |6400 IOPS                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|D8s_v3              |12800 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|D16s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D32s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D48s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D64s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**記憶體優化**|                                          |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |3200 IOPS                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|E4s_v3              |6400 IOPS                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|E8s_v3              |12800 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|E16s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E32s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E48s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E64s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |

以標示時 \* ，IOPS 會受限於您所選取的 VM 類型。 否則 IOPS 會受到所選儲存體大小的限制。

### <a name="maximum-io-bandwidth-mibsec-for-your-configuration"></a>您設定的最大 i/o 頻寬 (MiB/秒) 

|SKU 名稱            |儲存體大小，GiB                             |32 |64 |128 |256 |512  |1,024|2,048|4,096|8,192 |16,384|
|--------------------|----------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |**儲存體頻寬、MiB/秒**                |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**高載**       |                                              |   |   |    |    |     |     |     |     |      |      |
|B1ms                |10 MiB/秒                                    |10|10|10 |10 |10  |10  |10  |10  |10   |10   |
|B2s                 |15 MiB/秒                                    |長|長|長 |長 |長  |長  |長  |長  |長   |長   |
|**一般用途** |                                              |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |48 MiB/秒                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|D4s_v3              |96 MiB/秒                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|D8s_v3              |192 MiB/秒                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|D16s_v3             |384 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|D32s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D48s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D64s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**記憶體優化**|                                              |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |48 MiB/秒                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|E4s_v3              |96 MiB/秒                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|E8s_v3              |192 MiB/秒                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|E16s_v3             |384 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|E32s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E48s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E64s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |

以 a 標記時 \* ，i/o 頻寬會受限於您所選取的 VM 類型。 否則 i/o 頻寬會受到所選儲存體大小的限制。

### <a name="reaching-the-storage-limit"></a>到達儲存體限制

當您達到儲存體限制時，伺服器將會開始傳回錯誤，並防止任何進一步的修改。 這也可能會造成其他操作活動的問題，例如備份和 WAL 封存。

建議您主動監視使用中的磁碟空間，並在儲存空間不足的情況下，增加磁片大小。 您可以設定警示，以在伺服器存放裝置接近磁片時通知您，以避免發生磁碟空間不足的問題。 如需詳細資訊，請參閱[如何設定警示](howto-alert-on-metrics.md)的文件。

### <a name="storage-auto-grow"></a>儲存體自動成長

儲存體自動成長尚未提供彈性的伺服器。

## <a name="backup"></a>備份

服務會自動採用伺服器的備份。 您可以從7到35天的範圍內選取保留期限。 深入瞭解 [概念文章](concepts-backup-restore.md)中的備份。

## <a name="scale-resources"></a>調整資源

建立伺服器之後，您可以單獨變更虛擬核心、計算層、儲存體數量，以及備份保留期限。 虛擬核心數目可相應增加或減少。 備份保留期可在 7 到 35 天的範圍內相應增加或減少。 儲存體大小只能增加。 您可以透過入口網站或 Azure CLI 來調整資源。

> [!NOTE]
> 儲存體大小只能增加。 增加之後，您就無法返回較小的儲存體大小。

當您變更虛擬核心數目或計算層時，伺服器會重新開機，讓新的伺服器類型生效。 在系統切換到新伺服器的期間，您無法建立任何新的連線，且所有未認可的交易皆會復原。 此期間長短可能有所不同，但大部分情況下是少於一分鐘。 調整儲存體的運作方式相同，而且也需要短時間重新開機。

變更備份保留期限是一項線上作業。

## <a name="pricing"></a>定價

如需最新的定價資訊，請參閱服務的[定價頁面](https://azure.microsoft.com/pricing/details/PostgreSQL/)。 若要查看您所需的設定成本，[Azure 入口網站](https://portal.azure.com/#create/Microsoft.PostgreSQLServer)會根據您選取的選項，在 [定價層]**** 索引標籤中顯示每月成本。 如果您沒有 Azure 訂用帳戶，則可以使用 Azure 價格計算機來取得估計的價格。 在 [Azure 價格計算機](https://azure.microsoft.com/pricing/calculator/)網站上，選取 [新增項目]**** 展開 [資料庫]**** 類別，然後選擇 [適用於 PostgreSQL 的 Azure 資料庫]**** 以自訂選項。

## <a name="next-steps"></a>後續步驟

- 瞭解如何 [在入口網站中建立于 postgresql 伺服器](how-to-manage-server-portal.md)。
- 了解[服務限制](concepts-limits.md)。
