---
title: 瞭解定價-Azure 應用程式閘道
description: 本文說明 Azure 應用程式閘道和 Web 應用程式防火牆的計費程式（適用于 v1 至 v2 Sku）
services: application-gateway
author: azhar2005
ms.service: application-gateway
ms.topic: conceptual
ms.custom: references_regions
ms.date: 09/01/2020
ms.author: azhussai
ms.openlocfilehash: 1d88379726cfb6c4218c38b9ccc87005609a9aba
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/09/2020
ms.locfileid: "89460740"
---
# <a name="understanding-pricing-for-azure-application-gateway-and-web-application-firewall"></a>瞭解 Azure 應用程式閘道和 Web 應用程式防火牆的定價

>[!NOTE]
>本文所顯示的價格為範例，僅供說明之用。 如需根據您的地區的定價資訊，請參閱 [定價頁面](https://azure.microsoft.com/pricing/details/application-gateway/)。

Azure 應用程式閘道是第7層負載平衡解決方案，可在 Azure 上提供可擴充、高可用性且安全的 web 應用程式傳遞。

沒有與應用程式閘道相關聯的預付成本或終止成本。
您只需支付預先布建的資源，並根據實際的每小時耗用量使用的資源。 與應用程式閘道相關聯的成本會分為兩個元件：固定成本和可變成本。 每個元件中的實際成本會根據所使用的 SKU 而有所不同。

本文說明與每個 SKU 相關聯的成本，並建議使用者利用這份檔來規劃和管理與 Azure 應用程式閘道相關聯的成本。

## <a name="v1-skus"></a>V1 Sku

標準應用程式閘道和 WAF V1 Sku 會以下列組合計費：

* 固定成本

    根據特定類型的應用程式閘道/WAF 布建和執行處理要求的時間計算成本。
    固定成本元件會考慮下列因素：
    * 層標準應用程式閘道或 WAF
    * 大小-小型、中型 & 大型
    * 實例計數-要部署的實例數目

    若為 N 個實例，相關聯的成本將會是 N * 特定層的一個實例成本 (標準 & WAF) & 大小 (小型、中型 & 大型) 組合。

* 變數成本

    以應用程式閘道/WAF 所處理的資料量為基礎的成本。 應用程式閘道所處理的要求和回應位元組都會考慮計費。

總成本 = 固定成本 + 可變成本

### <a name="standard-application-gateway"></a>標準應用程式閘道

固定成本 & 變數成本會根據應用程式閘道類型來計算。
下表顯示根據美國東部價格的快照集的範例價格，僅供說明之用。

#### <a name="fixed-cost-east-us-region-pricing"></a>固定成本 (美國東部區域定價) 

|              應用程式閘道類型             |  成本 ($/小時)   |
| ------------------------------------------------- | ---------------|
|                     小型                         |    $0.025      |
|                     中                        |    $0.07       |
|                     大型                         |    $0.32       |

每月價格預估以每月730小時的使用量為基礎。

#### <a name="variable-cost-east-us-region-pricing"></a>可變成本 (美國東部區域定價) 

|              處理的資料             |  Small ($/GB)   |  中型 ($/GB)  |  大型 ($/GB)  |
| --------------------------------------- | -------------- | -------------- | ------------- |
| 前 10 TB/月                       |     $0.008     |      免費      |     免費      |
| 接下來的 30 TB (10 – 40 TB) /月             |     $0.008     |     $0.007     |     免費      |
| 超過 40 TB/月                        |     $0.008     |     $0.007     |     $0.0035   |

如需根據您的地區的詳細定價資訊，請參閱 [定價頁面](https://azure.microsoft.com/pricing/details/application-gateway/)。

### <a name="waf-v1"></a>WAF V1

固定成本 & 變數成本會根據布建的應用程式閘道類型來計算。

下表顯示根據美國東部價格的快照集的範例價格，僅供說明之用。

#### <a name="fixed-cost-east-us-region-pricing"></a>固定成本 (美國東部區域定價) 

|              應用程式閘道類型             |  成本 ($/小時)   |
| ------------------------------------------------- | ---------------|
|                     小型                         |       NA       |
|                     中                        |     $0.126     |
|                     大型                         |     $0.448     |

每月價格預估以每月730小時的使用量為基礎。

#### <a name="variable-cost-east-us-region-pricing"></a>可變成本 (美國東部區域定價) 

|              處理的資料             |  Small ($/GB)   |  中型 ($/GB)  |  大型 ($/GB)  |
| --------------------------------------- | -------------- | -------------- | ------------- |
| 前 10 TB/月                       |     $0.008     |      免費      |     免費      |
| 接下來的 30 TB (10 – 40 TB) /月             |     $0.008     |     $0.007     |     免費      |
| 超過 40 TB/月                        |     $0.008     |     $0.007     |     $0.0035   |

如需根據您的地區的詳細定價資訊，請參閱 [定價頁面](https://azure.microsoft.com/pricing/details/application-gateway/)。

> [!NOTE]
> 輸出資料傳輸-來自應用程式閘道的 Azure 資料中心傳出的資料將依標準 [資料傳輸費率](https://azure.microsoft.com/pricing/details/bandwidth/)計費。

### <a name="example-1-a--standard-application-gateway-with-1-instance-count"></a>範例 1 () –具有1個實例計數的標準應用程式閘道

假設您已布建具有1個實例的中型類型標準應用程式閘道，且每個月會處理 500 GB。 使用上面所述定價的應用程式閘道成本計算方式如下：

固定價格 = $0.07 * 730 (小時) = $51.1 每月價格預估以每月730小時的使用量為基礎。

變動成本 = 免費 (中層對於每月處理的前 10 TB 沒有任何費用) 總成本 = $51.1 + 0 = $51。1 

> [!NOTE]
> 若要支援高可用性案例，至少需要為 V1 Sku 設定2個實例。 查看 [應用程式閘道的 SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_2/)

### <a name="example-1-b--standard-application-gateway-with--1-instance-count"></a>範例 1 (b) –具有 > 1 實例計數的標準應用程式閘道

假設您已布建具有五個實例的中型類型標準應用程式閘道，且每個月會處理 500 GB。 使用上面所述定價的應用程式閘道成本計算方式如下：

固定價格 = 5 (實例計數) * $0.07 * 730 (小時) = $255.5 每月價格預估以每月730小時的使用量為基礎。

變動成本 = 免費 (中層對於每月處理的前 10 TB 沒有任何費用) 總成本 = $255.5 + 0 = $255。5 

### <a name="example-2--waf-application-gateway"></a>範例2– WAF 應用程式閘道

讓我們假設您已布建一個小型類型標準應用程式閘道，以及一個大型類型的 WAF 應用程式閘道，以供當月的前15天使用。 小型應用程式閘道會在作用中的持續時間內處理 15 TB，而大型 WAF 應用程式閘道會在作用中的持續時間內處理 100 TB。 使用上面所述定價的應用程式閘道成本計算方式如下： 

###### <a name="small-instance-standard-application-gateway"></a>小型實例標準應用程式閘道

24小時 * 15 天 = 360 小時

固定價格 = $0.025 * 360 (小時) = $9

變數成本 = 10 * 1000 * $ 0.008/GB + 5 * 1000 * $ 0.008/GB = $120

總成本 = $9 + $120 = $129

###### <a name="large-instance-waf-application-gateway"></a>大型實例 WAF 應用程式閘道
24小時 * 15 天 = 360 小時

固定價格 = $0.448 * 360 (小時) = $161.28

變數成本 = 60 * 1000 * $ 0.0035/GB = $210 (大型階層對於每月處理的前 40 TB 沒有任何費用) 

總成本 = $161.28 + $210 = $371.28

## <a name="v2-skus"></a>V2 Sku  

應用程式閘道 V2 和 WAF V2 Sku 支援自動調整，並預設保證高可用性。

### <a name="key-terms"></a>主要詞彙：

##### <a name="capacity-unit"></a>容量單位 
容量單位是跨多個參數的應用程式閘道容量使用率量值。

單一容量單位包含下列參數：
* 2500持續性連接
* 2.22-Mbps 輸送量
* 1個計算單位

如果超過上述任何一個參數，則需要另一個 n 容量單位 (s) ，即使其他兩個參數未超過這個單一容量單位的限制也是一樣。
上述三個最高使用率的參數將會在內部用來計算容量單位，然後再計費。

##### <a name="compute-unit"></a>計算單位
計算單位是使用的計算容量量值。 影響計算單位耗用量的因素包括 TLS 連線數/秒、URL 重寫計算和 WAF 規則處理。 計算單位可以處理的要求數目取決於各種準則，例如 TLS 憑證金鑰大小、金鑰交換演算法、標頭重寫，以及 WAF 傳入要求大小的情況。

計算單位指引：
* Standard_v2 - 每個計算單位能夠使用 RSA 2048 位元金鑰 TLS 憑證，每秒大約有 50 個連線。

* WAF_v2 - 每個計算單位可支援大約每秒 10 個並行要求，適用於 70-30% 的流量混合，其中 70% 要求少於 2 KB 的 GET/POST，而剩餘的則較高。 目前的回應大小不會影響 WAF 效能。

##### <a name="instance-count"></a>執行個體計數 
預先布建應用程式閘道 V2 Sku 的資源是根據實例計數來定義。 每個實例可保證最少有10個容量單位的處理功能。 根據容量單位參數而定，相同的實例可能會針對不同的流量模式支援超過10個容量單位。

針對自動調整設定的手動定義規模和限制 (最小值或最大值) 會根據實例計數設定。 自動調整設定中的實例計數和最小實例計數的手動設定規模將會保留10個容量單位/實例。 無論實際的資源耗用量為何，只要應用程式閘道都在作用中，這些保留的 Cu 就會收費。 如果實際耗用量超過10個容量單位/實例閾值，則額外的容量單位將會以變數元件計費。

V2 Sku 會根據耗用量計費，並由兩個部分組成：

* 固定成本

    成本是根據應用程式閘道 V2/WAF V2 的布建時間，並可用於處理要求。 這可確保高可用性，即使0個實例已保留，也是在自動調整的最小實例計數中指定0。 
    
    固定成本也包含與附加至應用程式閘道的公用 IP 相關聯的成本。

    在任何時間點執行的實例數目，都不會被視為 V2 Sku 固定成本的考慮因素。 無論在相同 Azure 區域內執行的實例數目為何，執行 Standard_V2 (或 WAF_V2) 的固定成本都將會每小時相同。

* 容量單位成本 

    根據處理傳入要求所需的保留或使用的容量單位數目計算成本。  以耗用量為基礎的成本是以每小時計算。

總成本 = 固定成本 + 容量單位成本

> [!NOTE]
> 部分小時的計費方式為一小時。

下表顯示根據美國東部價格的快照集的範例價格，僅供說明之用。

#### <a name="fixed-costs-east-us-region-pricing"></a>固定成本 (美國東部區域定價) 

|              V2 SKU             |  成本 ($/小時)   |
| ------------------------------- | ---------------|
|            Standard_V2          |     $0.246     |
|              WAF_V2             |     $0.443     |

每月價格預估以每月730小時的使用量為基礎。

#### <a name="variable-costs-east-us-region-pricing"></a>可變成本 (美國東部區域定價) 

|        容量單位         |  Standard_V2 ($/小時)   |  WAF_V2 ($/小時)  |
| ---------------------------- | -------------------- | -------------- |
|             1 CU             |        $0.008        |     $0.0144    |

如需根據您的地區的詳細定價資訊，請參閱 [定價頁面](https://azure.microsoft.com/pricing/details/application-gateway/)。

> [!NOTE]
> 輸出資料傳輸-來自應用程式閘道的 Azure 資料中心傳出的資料將依標準 [資料傳輸費率](https://azure.microsoft.com/pricing/details/bandwidth/)計費。

### <a name="example-1-a--manual-scaling"></a>範例 1 () –手動調整 
假設您已布建 Standard_V2 應用程式閘道，並將手動調整規模設定為整個月8個實例。 在這段期間內，它會收到平均 88.8-Mbps 的資料傳輸。

使用上面所述定價的應用程式閘道成本計算方式如下：

1 CU 可以處理 2.22-Mbps 的輸送量。

需要 Cu 才能處理 88.8 Mbps = 88.8/2.22 = 40 Cu 

預先布建的 Cu = 8 (實例計數) * 10 = 80 

因為 80 (保留容量) > 40 (所需的容量) ，所以不需要其他 Cu。 

固定價格 = $0.246 * 730 (小時) = $179.58

變數成本 = $0.008 * 8 (實例單位) * 10 (容量單位) * 730 (小時) = $467。2

總成本 = $179.58 + $467.2 = $646.78

![手動-調整1的圖表。](./media/pricing/manual-scale-1.png)

### <a name="example-1-b--manual-scaling-with-traffic-going-beyond-provisioned-capacity"></a>範例 1 (b) –手動調整流量超過布建容量的流量

讓我們假設您已布建 Standard_V2 的應用程式閘道，並將手動調整規模設定為整個月3個實例。 在這段期間內，它會收到平均 88.8-Mbps 的資料傳輸。

使用上面所述定價的應用程式閘道成本計算方式如下：

1 CU 可以處理 2.22 Mbps 的輸送量。

需要 Cu 才能處理 88.8 Mbps = 88.8/2.22 = 40 

預先布建的 Cu = 3 (實例計數) * 10 = 30 

由於 40 (必要容量) > 30 (保留容量) ，需要額外的 Cu。
使用的其他 Cu 數目取決於每個實例可用的可用容量。

如果有相當於10個額外 Cu 的處理容量可以在3個保留實例內使用。

固定價格 = $0.246 * 730 (小時) = $179.58

可變成本 = $0.008 * ( 3 (實例單位) * 10 (容量單位) + 5 (額外容量單位) ) * 730 (小時) = $204。4

總成本 = $179.58 + $204.4 = $383.98

![手動-調整2的圖表。](./media/pricing/manual-scale-2.png)

> [!NOTE]
> 在手動調整的情況下，任何額外的要求若超過保留實例的最大處理能力，可能會對您的應用程式可用性造成影響。 在高負載情況下，保留實例可能會根據傳入要求的設定和類型，提供超過10個處理容量的容量單位。 但建議根據您的流量需求布建實例數目。

### <a name="example-2--waf_v2-instance-with-autoscaling"></a>範例2–具有自動調整的 WAF_V2 實例

假設您已布建啟用自動調整的 WAF_V2，並將整個月的最小實例計數設定為6。 要求負載造成 WAF 實例相應放大，並利用65容量單位 (scale out of 5 個容量單位，而60單位則是保留) 給整個月。
使用上面所述定價的應用程式閘道成本計算方式如下：

每月價格預估以每月730小時的使用量為基礎。

固定價格 = $0.443 * 730 (小時) = $323.39

可變成本 = $0.0144 * 65 (容量單位) * 730 (小時) = $683.28

總成本 = $323.39 + $683.28 = $1006.67

![自動調整規模2的圖表。](./media/pricing/auto-scale-1.png)

> [!NOTE]
> 針對您的應用程式閘道觀察到的實際流量，不太可能會有這類的流量，而應用程式閘道上所觀察到的負載也會根據實際使用量而波動。

### <a name="example-3-a--waf_v2-instance-with-autoscaling-and-0-min-scale-config"></a>範例 3 () 的 WAF_V2 實例（具有自動調整規模和0最小值）

假設您已布建啟用自動調整的 WAF_V2，並將整個月的最小實例計數設定為0。 WAF 上的要求負載最少，但會在整個月每小時一致地出現。 負載低於單一容量單位的容量。
使用上面所述定價的應用程式閘道成本計算方式如下：

每月價格預估以每月730小時的使用量為基礎。

固定價格 = $0.443 * 730 (小時) = $323.39

變數成本 = $0.0144 * 1 (容量單位) * 730 (時數) = $10.512

總成本 = $323.39 + $10.512 = $333.902

### <a name="example-3-b--waf_v2-instance-with-autoscaling-with-0-min-instance-count"></a>範例 3 (b) –具有自動調整（具有0分鐘實例計數）的 WAF_V2 實例

假設您已布建啟用自動調整的 WAF_V2，並將整個月的最小實例計數設定為0。 不過，有0個流量會導向至整個月的 WAF 實例。
使用上面所述定價的應用程式閘道成本計算方式如下：

固定價格 = $0.443 * 730 (小時) = $323.39

變數成本 = $0.0144 * 0 (容量單位) * 730 (時數) = $0

總成本 = $323.39 + $0 = $323.39

### <a name="example-3-c--waf_v2-instance-with-manual-scaling-set-to-1-instance"></a>範例 3 (C) –將手動調整規模設定為1個實例的 WAF_V2 實例

讓我們假設您已布建 WAF_V2，並將其設定為手動調整，並以一個月的最小可接受值為1個實例。 不過，有0個流量會導向至整個月的 WAF。
使用上面所述定價的應用程式閘道成本計算方式如下：

每月價格預估以每月730小時的使用量為基礎。

固定價格 = $0.443 * 730 (小時) = $323.39

變數成本 = $0.0144 * 1 (實例計數) * 10 (容量單位) * 730 (小時) = $105.12

總成本 = $323.39 + $105.12 = $428.51

### <a name="example-4--waf_v2-with-autoscaling-capacity-unit-calculations"></a>範例 4-使用自動調整、容量單位計算 WAF_V2

假設您已布建啟用自動調整的 WAF_V2，並將整個月的最小實例計數設定為0。 在這段期間內，它會收到每秒25個新的 TLS 連線，平均為 8.88-Mbps 的資料傳輸。
使用上面所述定價的應用程式閘道成本計算方式如下：

每月價格預估以每月730小時的使用量為基礎。

固定價格 = $0.443 * 730 (小時) = $323.39

可變成本 = $0.0144 * 730 (小時) * {Max (25/50，8.88/2.22) } = $23.36 (處理 8.88 Mbps 所需的4個容量單位) 

總成本 = $323.39 + $23.36 = $346.75

### <a name="example-5-a--standard_v2-with-autoscaling-time-based-calculations"></a>範例 5 () –使用自動調整、以時間為基礎的計算 Standard_V2

讓我們假設您已布建啟用自動調整的 standard_V2，並將最小實例計數設定為0，且此應用程式閘道在2小時內有效。
在第一個小時內，它會接收可由10個容量單位處理的流量，而在第二個小時內，則會接收需要20個容量單位來處理負載的流量。
使用上面所述定價的應用程式閘道成本計算方式如下：

固定價格 = $0.246 * 2 (小時) = $0.492

可變成本 = $0.008 * 10 (容量單位) * 1 (小時) + $0.008 * 20 (容量單位) * 1 (小時) = $0.24

總成本 = $0.492 + $0.24 = $0.732


## <a name="monitoring-billed-usage"></a>監視計費使用量

您可以在 [ **監視** ] 區段下，查看不同參數的耗用量量 (計算單位、輸送量 & 持續連線) ，以及用來作為應用程式閘道計量一部分的容量單位。

![計量區段的圖表。](./media/pricing/metrics-1.png)

### <a name="useful-metrics-for-cost-estimation"></a>成本估計的實用計量

* 目前的容量單位

    針對三個參數的流量進行負載平衡所耗用的容量單位元數目-目前的連線、輸送量和計算單位

* 固定計費容量單位

    根據最小實例計數設定，保留布建的容量單位數目下限 (一個實例會在應用程式閘道設定中轉譯為10個容量單位) 。

* 預估計費容量單位

    預估計費容量單位表示用來預估計費的容量單位數。 這會以「目前容量單位數」(對流量進行負載平衡所需的容量單位) 和「固定計費容量單位」(持續佈建的最小容量單位) 之間的較大值進行計算。

您也可以使用更多的計量（例如輸送量、目前的連線和計算單位）來瞭解瓶頸，並估計所需的容量單位數目。 詳細資訊可在[應用程式閘道計量](application-gateway-metrics.md)中取得

#### <a name="example---estimating-capacity-units-being-utilized"></a>範例-估計使用的容量單位

**觀察到的計量：**

* 計算單位 = 17.38
* 輸送量 = 1.37 M Bytes/sec-10.96 Mbps
* 目前的連接 = 123.08 k
* 容量單位計算 = max (17.38、10.96/2.22、123.08 k/2500) = 49.232

計量中觀察到的容量單位 = 49.23

## <a name="next-steps"></a>後續步驟

請參閱下列文章，以深入瞭解定價在 Azure 應用程式閘道中的運作方式：

* [Azure 應用程式閘道定價頁面](https://azure.microsoft.com/pricing/details/application-gateway/)
* [Azure 應用程式閘道定價計算機](https://azure.microsoft.com/en-us/pricing/calculator/?service=application-gateway)
