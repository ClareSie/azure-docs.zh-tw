---
title: 身分識別模型
titleSuffix: An Azure Communication Services concept
description: 瞭解身分識別和存取權杖
author: tomaschladek
manager: nmurav
services: azure-communication-services
ms.author: tchladek
ms.date: 10/26/2020
ms.topic: conceptual
ms.service: azure-communication-services
ms.openlocfilehash: 996f138a14923319381738e7a55cd7ba4e8c4320
ms.sourcegitcommit: 5831eebdecaa68c3e006069b3a00f724bea0875a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/11/2020
ms.locfileid: "94517762"
---
# <a name="identity-model"></a>身分識別模型

Azure 通訊服務是身分識別中立的服務。 此設計有多項優點：
- 從您的身分識別管理系統重複使用現有的身分識別
- 整合案例的彈性
- 將您的身分識別保留在 Azure 通訊服務的私用

與其複製您的系統中的現有資訊，您將會維護商務案例專屬的對應關聯性，而不是複製您系統中的現有資訊。 例如，識別碼1:1、1： N、N：1、N:M. 的對應 外部識別碼 (例如電話號碼、使用者、裝置、應用程式、GUID) 不能用來作為 Azure 通訊身分識別。 針對 Azure 通訊服務身分識別所產生的存取權杖可用來存取基本專案，例如聊天或呼叫。 

## <a name="identity"></a>身分識別

身分識別是使用 Azure Communication Service 管理程式庫所建立。 身分識別會作為交談中的識別碼，並用於建立存取權杖。 相同的身分識別可能會在多個裝置上參與多個同時會話。 身分識別可能同時有多個作用中存取權杖。 刪除身分識別、資源或訂用帳戶會導致所有存取權杖失效，以及刪除為此身分識別儲存的所有資料。 已刪除的身分識別無法發出新的存取權杖，也不會存取先前儲存的資料 (例如) 的聊天訊息。 

您不需支付所擁有的身分識別數目，而是使用基本類型。 身分識別數目不需要限制，如何將應用程式的身分識別對應至 Azure 通訊服務身分識別。 有了對應的自由，在隱私權方面都有責任。 當您的應用程式使用者想要從系統中刪除時，您需要刪除與該使用者相關聯的所有身分識別。

Azure 通訊服務不提供匿名使用者的特殊身分識別。 它不會保留使用者和身分識別之間的對應，也不會瞭解身分識別是否為匿名。 您可以根據您的需求來設計概念。 建議您為每個應用程式的匿名使用者建立新的身分識別。 擁有有效的存取權杖後，任何人都可以存取身分識別未刪除的內容。 例如，使用者所傳送的聊天訊息。 存取權僅限於存取權杖中的範圍。 有關範圍的詳細資訊位於區段 *存取權杖* 中。

### <a name="mapping-of-identities"></a>身分識別的對應

Azure 通訊服務不會複寫 IMS 的功能。 它不提供客戶使用客戶專屬身分識別的方式。 例如，電話號碼或電子郵件地址。 相反地，它會提供唯一識別碼，您可以將其指派給應用程式的身分識別。 Azure 通訊服務不會儲存任何種類的資訊，這可能會顯示使用者的真實身分識別。

建議您進行設計，而不是重複，您的身分識別網域中的使用者將如何對應至 Azure 通訊服務身分識別。 您可以遵循任何種類的模式1:1，1： N、N：1或 M:N。 您可以決定單一使用者是否對應到單一身分識別或多個身分識別。 建立新的身分識別時，建議您將此身分識別的對應儲存至您應用程式的使用者或使用者。 因為身分識別需要存取權杖才能使用基本專案，所以您的應用程式使用者或使用者必須知道該身分識別。

如果您使用關係資料庫來儲存使用者，則根據您的對應案例，該執行可能會有所不同。 在對應1:1 或 N：1的案例中，您可以將 *CommunicationServicesId* 資料行新增至資料表，以儲存您的 Azure 通訊服務身分識別。 在關聯性1： N 或 N:M 的案例中，您可以考慮在關係資料庫中建立個別的資料表。

## <a name="access-token"></a>存取權杖

存取權杖是 JWT 權杖，可用來存取 Azure 通訊服務基本專案。 發出的存取權杖有完整性保護，無法在發出之後變更其宣告。 也就是說，手動變更屬性（例如身分識別、到期或範圍）會使存取權杖無效。 使用無效權杖的基本專案，將會導致拒絕存取基本的存取。 

存取權杖的屬性為：身分 *識別、到期* 日及 *範圍* 。 存取權杖的有效時間一律為24小時。 在這段時間之後，存取權杖將會失效，且無法用來存取任何基本。 身分識別必須有一種方法，也就是如何向伺服器端服務要求新的存取權杖。 參數 *範圍* 會定義可使用的一組非空白基本物件。 Azure 通訊服務支援下列存取權杖範圍：

|名稱|描述|
|---|---|
|聊天|  授與參與聊天的能力|
|VoIP|  授與呼叫身分識別和電話號碼的能力|


如果您想要在到期前撤銷存取權杖，您可以使用 Azure Communication Service 管理程式庫來執行此作業。 權杖的撤銷並非立即的，且需要最多15分鐘的時間來傳播。 移除身分識別、資源或訂用帳戶將會導致所有存取權杖撤銷。 如果您想要移除使用者存取特定功能的能力，請撤銷所有存取權杖。 然後使用一組較有限的範圍來發出新的存取權杖。
Azure 通訊服務的存取金鑰輪替會導致所有使用先前存取金鑰建立之作用中存取權杖的撤銷。 所有身分識別都會失去 Azure 通訊服務的存取權，而且必須發出新的存取權杖。 

建議您在伺服器端服務中發出存取權杖，而不是在用戶端的應用程式中發出。 原因是，發行需要存取金鑰或受控身分識別。 基於安全性理由，不建議將存取金鑰與用戶端的應用程式共用。 用戶端應用程式應該使用可驗證用戶端的信任服務端點，並代表其發出存取權杖。 您可以在 [這裡](./client-and-server-architecture.md)找到更多有關架構的詳細資料。

如果您將存取權杖快取到備份存放區，我們建議使用加密。 存取權杖是敏感性資料，如果未受保護，則可用於惡意活動。 擁有存取權杖之後，您就可以初始化 SDK 並取得 API 的存取權。 可存取的 API 只會根據存取權杖擁有的範圍受到限制。 建議您只使用需要的範圍發出存取權杖。

## <a name="next-steps"></a>後續步驟

* 如需存取權杖管理的簡介，請參閱 [建立和管理存取權杖](https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens)
* 如需驗證的簡介，請參閱驗證 [Azure 通訊服務](https://docs.microsoft.com/azure/communication-services/concepts/authentication)
* 如需資料落地和隱私權的簡介，請參閱[區域可用性和資料](https://docs.microsoft.com/azure/communication-services/concepts/privacy)落地